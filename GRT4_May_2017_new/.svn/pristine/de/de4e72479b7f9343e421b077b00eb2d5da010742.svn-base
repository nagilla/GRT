!function(a){"use strict";function b(){this.cobrowse=null}b.prototype={createCustomerCobrowse:function(a){if(!a)throw"Cobrowse configuration is not defined.";return!this.cobrowse&&a.enabled&&(this.cobrowse=new b.Services.Cobrowse.Customer.CustomerCobrowse(a)),this.cobrowse},createAgentCobrowse:function(a){if(!a)throw"Cobrowse configuration is not defined.";return!this.cobrowse&&a.enabled&&(this.cobrowse=new b.Services.Cobrowse.Agent.AgentCobrowse(a)),this.cobrowse},registerLogger:function(a){b.Base.CobrowseLogger.addCobrowseLogger(a)}},a.AvayaCoBrowseClientServices=b}(window),function(a){"use strict";!function(a){a.Base=a.Base||{}}(a),function(a){a.Config=a.Config||{}}(a),function(a){a.Services=a.Services||{}}(a),function(a){a.Services.Cobrowse=a.Services.Cobrowse||{}}(a),function(a){a.Services.Cobrowse.Agent=a.Services.Cobrowse.Agent||{}}(a),function(a){a.Services.Cobrowse.Customer=a.Services.Cobrowse.Customer||{}}(a),function(a){a.Services.Cobrowse.Common=a.Services.Cobrowse.Common||{}}(a)}(AvayaCoBrowseClientServices),function(a){"use strict";!function(a){a.Providers=a.Providers||{}}(a),function(a){a.Providers.Cobrowse=a.Providers.Cobrowse||{}}(a),function(a){a.Providers.Cobrowse.Customer=a.Providers.Cobrowse.Customer||{}}(a),function(a){a.Providers.Cobrowse.Agent=a.Providers.Cobrowse.Agent||{}}(a),function(a){a.Providers.Interfaces=a.Providers.Interfaces||{}}(a)}(AvayaCoBrowseClientServices),function(a){"use strict";var b={set:function(a,b,c,d){var e;if(d){var f=new Date;f.setTime(f.getTime()+24*d*60*60*1e3),e="; expires="+f.toGMTString()}else e="";document.cookie=c?a+"="+b+e+"; path=/; domain="+c:a+"="+b+e+"; path=/"},get:function(a){for(var b,c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(b=d[e];" "===b[0];)b=b.substring(1,b.length);if(0===b.indexOf(c))return b.substring(c.length,b.length)}return null},erase:function(a,b){this.set(a,"",b,-1)}};a.Base.CobrowseCookie=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={"CB.INACTIVE_TIMEOUT_MESSAGE":"","CB.SESSION_TIMEOUT":"","CB.INACTIVE_TIMEOUT":""};a.Base.CobrowseDataOptions=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.passPhrase=void 0,this.externalKey=void 0,this.cobrowseState=void 0,this.agentControlState=void 0,this.transcript=void 0,this.sessionStartTime=void 0,this.cobrowsedUrl=void 0,this.apiKey=void 0,this.sessionLocale=void 0,this.securityIp=void 0,this.agentName=void 0,this.agtProtocolToConnect=void 0,this.agtStartTime=void 0,this.agtAuthCode=void 0,this.agtRegisteredUi=void 0,this.agtReasonForDisconnect=void 0,this.agtPhotoUrl=void 0,this.agtUserAgent=void 0,this.customerName=void 0,this.custProtocolToConnect=void 0,this.custStartTime=void 0,this.custAuthCode=void 0,this.custRegisteredUi=void 0,this.custReasonForDisconnect=void 0,this.custPhotoUrl=void 0,this.custUserAgent=void 0,this.custSessionTransferInProgress=void 0}b.prototype={getPassPhrase:function(){return this.passPhrase},getCobrowseState:function(){return this.cobrowseState},getAgentControlState:function(){return this.agentControlState},getAgentName:function(){return this.agentName},getAgentAuthCode:function(){return this.agtAuthCode},getAgentReasonForDisconnect:function(){return this.agtReasonForDisconnect},getCustomerName:function(){return this.customerName},getCustomerAuthCode:function(){return this.custAuthCode},getCustomerReasonForDisconnect:function(){return this.custReasonForDisconnect}},a.Base.CobrowseSessionInfo=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(c){this.isAllowed=c===a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED,this.denialReason=c,this._onChangedCallbacks=b.Callbacks()}c.prototype={addOnChangedCallback:function(a){this._onChangedCallbacks.add(a)},removeOnChangedCallback:function(a){this._onChangedCallbacks.remove(a)},_updateIfChanged:function(a,b){this.isAllowed===a&&this.denialReason===b||(this.isAllowed=a,this.denialReason=b,this._onChangedCallbacks.fire(this))}},a.Base.CoBrowseCapability=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={CAPABILITY_NOT_DENIED:"CAPABILITY_NOT_DENIED",CAPABILITY_INVALID_STATE:"CAPABILITY_INVALID_STATE"};a.Base.CobrowseCapabilityDenialReason=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.passPhrase=void 0,this.authKey=void 0,this.superVisor=void 0,this.coBrowseSessionInfo=new a.Base.CobrowseSessionInfo,this.options={},this.redirectURL=void 0}a.Base.CobrowseData=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(a){this.dataSet=a,this.dataRetrievalProgress=$.Callbacks(),this.dataRetrievalDone=$.Callbacks(),this.dataRetrievalFailed=$.Callbacks()}b.prototype={getCobrowseDataSet:function(){return this.dataSet},addOnCobrowseDataRetrievalProgressCallback:function(a){this.dataRetrievalProgress.add(a)},removeOnCobrowseDataRetrievalProgressCallback:function(a){this.dataRetrievalProgress.remove(a)},onCobrowseDataRetrievalProgress:function(a,b,c){this.dataRetrievalProgress.fire(this,arguments)},addOnCobrowseDataRetrievalDoneCallback:function(a){this.dataRetrievalDone.add(a)},removeOnCobrowseDataRetrievalDoneCallback:function(a){this.dataRetrievalDone.remove(a)},onCobrowseDataRetrievalDone:function(){this.dataRetrievalDone.fire(this,arguments)},addOnCobrowseDataRetrievalFailedCallback:function(a){this.dataRetrievalFailed.add(a)},removeOnCobrowseDataRetrievalFailedCallback:function(a){this.dataRetrievalFailed.remove(a)},onCobrowseDataRetrievalFailed:function(a){this.dataRetrievalFailed.fireWith(this,arguments)}},a.Base.CobrowseDataRetrieval=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(){this.dataSetChangeCallbacks=b.Callbacks(),this.dataSetInvalidatedCallbacks=b.Callbacks(),this.coBrowseData=new a.Base.CobrowseData}c.prototype=Object.create(a.Base.CobrowseData.prototype),c.prototype.updateDataset=function(a){b.extend(this.coBrowseData,a)},c.prototype.addOnCobrowseDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.add(a)},c.prototype.removeOnCobrowseDataSetChangedCallback=function(a){this.dataSetChangeCallbacks.remove(a)},c.prototype.onCobrowseDataSetChanged=function(){this.dataSetChangeCallbacks.fire(this)},c.prototype.addOnCobrowseDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.add(a)},c.prototype.removeOnCobrowseDataSetInvalidatedCallback=function(a){this.dataSetInvalidatedCallbacks.remove(a)},c.prototype.onCobrowseDataSetInvalidated=function(){this.dataSetInvalidatedCallbacks.fire(this)},a.Base.CobrowseDataSet=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(a,b,c){Error.call(this,c),this._errorCode=a,this._reason=b,this._message=c}b.prototype=Object.create(Error.prototype),b.prototype.getErrorCode=function(){return this._errorCode},b.prototype.getReason=function(){return this._reason},b.prototype.getMessage=function(){return this._message},a.Base.CoBrowseError=b}(AvayaCoBrowseClientServices),function(){"use strict";function a(a,b,c,d){void 0!==d?a[b](c,d):a[b](c)}function b(a,b,c,d){void 0!==d?a.log(b,c,d):a.log(b,c)}var c=[];AvayaCoBrowseClientServices.Base.CobrowseLogger={log:function(a,d,e){c.forEach(function(c){b(c,a,d,e)})},info:function(d,e){c.forEach(function(c){"function"==typeof c.info?a(c,"info",d,e):b(c,"info",d,e)})},error:function(d,e){c.forEach(function(c){"function"==typeof c.error?a(c,"error",d,e):b(c,"error",d,e)})},fatal:function(d,e){c.forEach(function(c){"function"==typeof c.fatal?a(c,"fatal",d,e):b(c,"fatal",d,e)})},debug:function(d,e){c.forEach(function(c){"function"==typeof c.debug?a(c,"debug",d,e):b(c,"debug",d,e)})},trace:function(d,e){c.forEach(function(c){"function"==typeof c.trace?a(c,"trace",d,e):b(c,"trace",d,e)})},warn:function(d,e){c.forEach(function(c){"function"==typeof c.warn?a(c,"warn",d,e):b(c,"warn",d,e)})},addCobrowseLogger:function(a){if(!a||void 0===a.log)throw new TypeError("CobrowseLogger should implement log method.");c.push(a)},removeCobrowseLogger:function(a){var b=c.indexOf(a);if(-1===b)throw new Error("Specified error does not exist.");c.splice(b,1)}}}(),function(a,b){"use strict";function c(){this._listeners={}}c.prototype={on:function(a,b){return"function"!=typeof b?this:(this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b),this)},off:function(a,b){if("function"!=typeof b)return this;if(void 0===this._listeners[a])throw new Error("There is no such handler for event with name: "+a+".");var c=this._listeners[a].indexOf(b);if(-1===c)throw new Error("There is no such handler for event with name: "+a+".");return this._listeners[a].splice(c,1),this},trigger:function(a,c,d){var e=this._listeners[a];void 0!==e&&(c=c||[],b.each(e,function(a,b){d?b.call(d,c):b.call(window,c)}))},_removeListeners:function(){for(var a in this._listeners)if(this._listeners.hasOwnProperty(a))for(var b=0;b<this._listeners[a].length;b++)this.off(a,this._listeners[a][b])}},a.Base.Observable=c}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{},jQuery||{}),function(a){"use strict";function b(){}b.prototype={state:function(){},always:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("alwaysCallback is not a function")},done:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("doneCallback is not a function")},fail:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("failCallback is not a function")},progress:function(b){"function"!=typeof b&&a.Base.CobrowseLogger.warn("progressCallback is not a function")},then:function(b,c,d){"function"!=typeof b?a.Base.CobrowseLogger.warn("doneCallback is not a function"):"function"!=typeof c?a.Base.CobrowseLogger.warn("failCallback is not a function"):"function"!=typeof d&&a.Base.CobrowseLogger.warn("progressCallback is not a function")}},a.Base.CobrowsePromise=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._config={},this._credentialProvider={}}b.prototype={start:function(b,c,d){this._config=b,this._credentialProvider=c,this.onOpen(),d&&a.Base.CobrowseLogger.info(d)},send:function(b,c){c&&a.Base.CobrowseLogger.info(c),b&&a.Base.CobrowseLogger.info(b)},_onCredentialsRequired:function(b){b&&a.Base.CobrowseLogger.info(b)},close:function(){this.onClose()},onOpen:function(){},onClose:function(){},onMessage:function(b){b&&a.Base.CobrowseLogger.info(b)},onError:function(b){a.Base.CobrowseLogger.error(b)}},a.Base.AbstractNetworkProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(a){this._sockJSNetowrkProvider=a,this.idCounter=1,this.resultListeners=[],this.notificationListeners=[],this.notificationListenersObjectOwner=[]}b.prototype.start=function(a){this._sockJSNetowrkProvider=a},b.prototype.attach=function(b,c,d,e){var f=b+"."+c;this.notificationListeners[f]&&(a.Base.CobrowseLogger.warn("multiple listeners for event: "+f),delete this.notificationListeners[f]),this.notificationListenersObjectOwner[f]&&(a.Base.CobrowseLogger.warn("multiple listeners for event: "+f),delete this.notificationListenersObjectOwner[f]),a.Base.CobrowseLogger.debug("listener registered for event: "+f),this.notificationListeners[f]=d,this.notificationListenersObjectOwner[f]=e},b.prototype.detach=function(a,b){var c=a+"."+b;delete this.notificationListeners[c],delete this.notificationListenersObjectOwner[c]},b.prototype.call=function(){var a=Array.prototype.slice.call(arguments);if(!(a.length<2)){var b=a[0],c=a[1],d=null,e=null;a.length>2&&"function"==typeof a[a.length-1]&&(d=a.pop(),a.length>2&&"function"==typeof a[a.length-1]&&(e=d,d=a.pop()));var f=null;a.length>2&&(f=a.slice(2));var g={jsonrpc:"2.0",service:b,method:c,params:f};return d&&(g.id=this.idCounter++,this.resultListeners[g.id]={success:d,failure:e}),this._sockJSNetowrkProvider.send(JSON.stringify(g)),g.id}},b.prototype.send=function(a,b,c,d){if(!(Array.prototype.slice.call(arguments).length<2)){var e=a,f=b,g=c,h={jsonrpc:"2.0",service:e,method:f,params:g};return d&&(h.id=this.idCounter++,this.resultListeners[h.id]={deffered:d}),this._sockJSNetowrkProvider.send(JSON.stringify(h)),h.id}},b.prototype.evtOnMessageHandler=function(b){var c,d=JSON.parse(b);if("2.0"===d.jsonrpc){if(null!==d.result&&void 0!==d.result)return d.id?(c=this.resultListeners[d.id])?(delete this.resultListeners[d.id],c.deffered?(c.deffered.resolve(d.result),c.deffered.promise()):void c.success(d.result)):void a.Base.CobrowseLogger.error("invalid id"):void a.Base.CobrowseLogger.error("no id for message");if(d.error)return d.id?(c=this.resultListeners[d.id])?(delete this.resultListeners[d.id],c.failure||c.deffered?c.deffered?(c.deffered.reject(d.error),c.deffered.promise()):void c.failure(d.error):void a.Base.CobrowseLogger.debug("ignore. no error callback for message")):void a.Base.CobrowseLogger.error("invalid id"):void a.Base.CobrowseLogger.debug("ignore. no id for message");if(d.method){var e=this.notificationListeners[d.method],f=this.notificationListenersObjectOwner[d.method],g=0;e?f?e.apply(f,d.params):e.apply(window,d.params):g=-32601,d.id&&(c={jsonrpc:"2.0"},0!==g?c.error={code:g,message:"Method not found"}:c.result="",c.id=d.id,this._sockJSNetowrkProvider.send(JSON.stringify(c)))}}},a.Base.JsonRPCProvider=b}(AvayaCoBrowseClientServices),function(a,b){"use strict";function c(){a.Base.AbstractNetworkProvider.apply(this),this._xhrPool=[]}c.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),c.prototype.defaultOptions={url:void 0,sendType:"POST",urlSuffix:"",dataType:"text",headers:{},processData:!0},c.prototype.send=function(a,c){var d=b.extend({},this.defaultOptions,c),e=this._getServerURL(d),f={url:e,type:d.sendType,dataType:d.dataType,headers:d.headers,processData:d.processData,beforeSend:function(a){this._xhrPool.push(a)}.bind(this)};if(a&&(f.data=a),d.crossDomain&&!0===d.crossDomain&&(f.xhrFields={withCredentials:!0},f.crossDomain=!0),d.authentication&&"Basic"===d.authentication.type){var g="Basic "+btoa(d.authentication.username+":"+d.authentication.password);f.beforeSend=function(a){a.setRequestHeader("Authorization",g),this._xhrPool.push(a)}.bind(this)}return b.ajax(f).then(function(a,b,c){return this._xhrPool.splice(this._xhrPool.indexOf(c),1),this.onMessage(a,c),a}.bind(this),function(a){return this.onError(a),a}.bind(this))},c.prototype._getServerURL=function(a){var b="";return void 0!==a.url?b=a.url:(b+=this._config.isSecure?"https://":"http://",b+=this._config.hostName+":"+this._config.port,b+=a.urlSuffix),b},c.prototype.close=function(){this._xhrPool.forEach(function(a){a.abort()}),this._xhrPool=[],this.onClose()},a.Base.RESTProvider=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(){a.Base.AbstractNetworkProvider.apply(this),this._sockJSConn=void 0,this._isOpened=!1,this._errorCount=0,this._isShutdown=!1,this._cbprotocols=["xhr-polling","xdr-polling"],this._options={transports:this._cbprotocols}}b.prototype=Object.create(a.Base.AbstractNetworkProvider.prototype),b.prototype.onConnectionUnavailable=function(){},b.prototype.start=function(a,b){if(this._isOpened)this.onOpen();else{if(this._config=a,this._isShutdown=!1,void 0===SockJS)return void this.onConnectionUnavailable();this._createSockJSConnection(b)}},b.prototype.send=function(a){var b=$.Deferred();return this.isOpened()?(this._sockJSConn.send(a),b.resolve()):b.reject("Socket is not opened!"),b.promise()},b.prototype.close=function(){this._isShutdown=!0,this._isOpened?(this._sockJSConn.close(),this._isOpened=!1):this._sockJSConn&&this.onClose(),this._errorCount=0,this._sockJSConn=void 0},b.prototype.isOpened=function(){return this._isOpened&&1===this._sockJSConn.readyState},b.prototype._getServerURL=function(a){var b="";return a&&void 0!==a.url?b=a.url:(b+=this._config.isSecure?"https://":"http://",b+=this._config.hostName,this._config.port&&(b+=":"+this._config.port)),a&&void 0!==a.urlSuffix&&(b+=a.urlSuffix),b},b.prototype._createSockJSConnection=function(a){this._isOpening=!0,this._sockJSConn=new SockJS(this._getServerURL(a),null,this._options),this._sockJSConn.onopen=function(){this._isOpening=!1,this._isShutdown?this._sockJSConn.close():(this._isOpened=!0,this._errorCount=0,this.onOpen())}.bind(this),this._sockJSConn.onmessage=function(a){this.onMessage(a)}.bind(this),this._sockJSConn.onclose=function(a){this._isOpening||(this._isOpened=!1,this._sockJSConn=void 0,this.onClose(a))}.bind(this),this._sockJSConn.onerror=function(a){this.onError(a)}.bind(this)},b.prototype._handleReconnect=function(a,b){this._isOpened||(this._errorCount+=1,this._errorCount>=this._config.maxConnectionErrorCount||this._isShutdown?(this._isOpening=!1,this.onConnectionUnavailable(a)):this._createSockJSConnection(b))},b.prototype.getProtocol=function(){return this._sockJSConn?this._sockJSConn.protocol:(a.Base.CobrowseLogger.error("Connection is not defined, Unable to tell protocol"),null)},a.Base.SockJSNetowrkProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.enabled=!1,this.serverInfo=new a.Config.ServerInfo,this.maxConnectionErrorCount=5}b.prototype={},a.Config.CoBrowseConfiguration=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this.hostName="",this.port=0,this.isSecure=!1}b.prototype={},a.Config.ServerInfo=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._cobrowseNetworkProvider=new a.Providers.Cobrowse.CobrowseNetworkProvider,this._cobrowseConfig=null}b.prototype={start:function(b){this._cobrowseConfig=b,this._cobrowseNetworkProvider.init(this._cobrowseConfig.serverInfo);var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SERVERSTATUSURL,this._cobrowseNetworkProvider.send({},c)},startSocketConnection:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;c.urlSuffix=b||a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SOCKETSERVICEURL,this._cobrowseNetworkProvider.startSocketConnection(c)},stopSocketConnection:function(){this._cobrowseNetworkProvider.stop()},requestSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.REQUESTURL,this._cobrowseNetworkProvider.send(b,c)},joinSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.JOINURL,this._cobrowseNetworkProvider.send(b,c)},joinLiveSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.LIVEJOINURL,this._cobrowseNetworkProvider.send(b,c)},statusSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.STATUSURL,this._cobrowseNetworkProvider.send(b,c)},logoutSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.LOGOUTURL,this._cobrowseNetworkProvider.send(b,c)},callJsonRPC:function(){return this._cobrowseNetworkProvider.callJsonRPC.apply(this._cobrowseNetworkProvider,arguments)},sendJsonRPC:function(a,b,c,d){return this._cobrowseNetworkProvider.sendJsonRPC.call(this._cobrowseNetworkProvider,a,b,c,d)},attachNetworkEvent:function(a,b){return this._cobrowseNetworkProvider.on(a,b)},registerServerCallback:function(a,b,c){this._cobrowseNetworkProvider.attach("agentservice",a,b,c)}},a.Providers.Cobrowse.Agent.AgentCobrowseProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";var b={SERVERSTATUSURL:"/services/cecobrowsega/v1/server/status",REQUESTURL:"/services/cecobrowsega/v1/agent/session/request",JOINURL:"/services/cecobrowsega/v1/agent/session/join",LIVEJOINURL:"/services/cecobrowsega/v1/agent/session/live/join",STATUSURL:"/services/cecobrowsega/v1/agent/status",LOGOUTURL:"/services/cecobrowsega/v1/agent/session/logout",SOCKETSERVICEURL:"/services/cecobrowsega/sockjs/cobrowse/agent"};a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={url:void 0,sendType:"GET",urlSuffix:"/services/cecobrowsega/v1/server/status",dataType:"JSON",headers:{},processData:!0};a.Providers.Cobrowse.CobrowseNetworkOptions=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";function c(b,c){a.Base.Observable.apply(this),this._restProvider=b,this._sockJSNetworkProvider=c,this._jsonProvider=void 0,this._config=void 0}c.prototype=Object.create(a.Base.Observable.prototype),c.prototype.addTrigger=function(b){this._sockJSNetworkProvider.onMessage=function(c){if("string"==typeof c.data){if("keepalive"===c.data)return void a.Base.CobrowseLogger.debug("keepalive: "+c);b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c.data,b._jsonProvider)}else b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c.data)},this._sockJSNetworkProvider.onError=function(c){a.Base.CobrowseLogger.error("OnError: "+c),b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_ERROR)},this._sockJSNetworkProvider.onOpen=function(){b._jsonProvider=new a.Base.JsonRPCProvider(b._sockJSNetworkProvider),b.addSockJSHandler(b),b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN)},this._sockJSNetworkProvider.onClose=function(c){b.trigger(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,{wasClean:c.wasClean,code:c.code,reason:c.reason}),b._removeListeners(),b._jsonProvider=void 0}},c.prototype.addSockJSHandler=function(b){var c=b._jsonProvider.evtOnMessageHandler;b.on(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_MESSAGE,c)},c.prototype.init=function(b){this._config=b,this._restProvider||(this._restProvider=new a.Base.RESTProvider),this._sockJSNetworkProvider||(this._sockJSNetworkProvider=new a.Base.SockJSNetowrkProvider),this._restProvider._config=this._config,this._sockJSNetworkProvider._config=this._config},c.prototype.startSocketConnection=function(a){this.addTrigger(this),this._sockJSNetworkProvider.start(this._config,a)},c.prototype.stop=function(){this._sockJSNetworkProvider&&(this._removeListeners(),this._sockJSNetworkProvider.close())},c.prototype.send=function(b,c){return this._restProvider.send(b,c).then(function(a){return a},function(b){return a.Base.CobrowseLogger.log("error in rest sending"),this._handleError(b)}.bind(this))},c.prototype.callJsonRPC=function(){return this._jsonProvider.call.apply(this._jsonProvider,arguments)},c.prototype.sendJsonRPC=function(a,c,d){var e=b.Deferred(),f=function(a){e.resolve(a)},g=function(a){e.reject(this._handleError(a))};return this._jsonProvider.send.call(this._jsonProvider,a,c,d,e),e.then(f.bind(this),g.bind(this)),e.promise()},c.prototype.attach=function(a,b,c,d){this._jsonProvider.attach(a,b,c,d)},c.prototype.detach=function(a,b){this._jsonProvider.detach(a,b)},c.prototype.getProtocol=function(){this._sockJSNetworkProvider.getProtocol.call(this._sockJSNetworkProvider)},c.prototype._handleError=function(b){var c="Unknown Code",d="Unknown Reason",e="Unknown Error";if(!b)return new a.Base.CoBrowseError(c,d,e);if(d=b,b.errorMessage)e=b.errorMessage,b.errorCode&&(c=b.errorCode);else if(b.data){var f=b.data.split("::");f.length>1&&(e=f[1],c=f[0])}return a.Base.CobrowseLogger.warn(JSON.stringify(b)),new a.Base.CoBrowseError(c,d,e)},a.Providers.Cobrowse.CobrowseNetworkProvider=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={SOCKET_ON_OPEN:"cbprovider.onOpen",SOCKET_ON_CLOSE:"cbprovider.onClose",SOCKET_ON_MESSAGE:"cbprovider.onMessage",SOCKET_ON_ERROR:"cbprovider.onError"};a.Providers.Cobrowse.ObservableEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(){this._cobrowseNetworkProvider=new a.Providers.Cobrowse.CobrowseNetworkProvider,this._cobrowseConfig=null}b.prototype={init:function(b){this._cobrowseConfig=b,this._cobrowseNetworkProvider.init(this._cobrowseConfig.serverInfo);var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SERVERSTATUSURL,this._cobrowseNetworkProvider.send({},c)},startSocketConnection:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;c.urlSuffix=b||a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SOCKETSERVICEURL,this._cobrowseNetworkProvider.startSocketConnection(c)},stopSocketConnection:function(){this._cobrowseNetworkProvider.stop()},requestSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.REQUESTURL,this._cobrowseNetworkProvider.send(b,c)},joinSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.JOINURL,this._cobrowseNetworkProvider.send(b,c)},statusSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.STATUSURL,this._cobrowseNetworkProvider.send(b,c)},logoutSession:function(b){var c=a.Providers.Cobrowse.CobrowseNetworkOptions;return c.urlSuffix=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.LOGOUTURL,this._cobrowseNetworkProvider.send(b,c)},callJsonRPC:function(){return this._cobrowseNetworkProvider.callJsonRPC.apply(this._cobrowseNetworkProvider,arguments)},sendJsonRPC:function(a,b,c,d){return this._cobrowseNetworkProvider.sendJsonRPC.call(this._cobrowseNetworkProvider,a,b,c,d)},attachNetworkEvent:function(a,b){return this._cobrowseNetworkProvider.on(a,b)},registerServerCallback:function(b,c,d){this._cobrowseNetworkProvider.attach(a.Services.Cobrowse.Common.CobrowseConstants.CUSTOMERSERVICE,b,c,d)},getProtocol:function(){this._cobrowseNetworkProvider.getProtocol.call(this._cobrowseNetworkProvider)}},a.Providers.Cobrowse.Customer.CustomerCobrowseProvider=b}(AvayaCoBrowseClientServices),function(a){"use strict";var b={SERVERSTATUSURL:"/services/cecobrowsega/v1/server/status",REQUESTURL:"/services/cecobrowsega/v1/customer/session/request",JOINURL:"/services/cecobrowsega/v1/customer/session/join",STATUSURL:"/services/cecobrowsega/v1/customer/status",LOGOUTURL:"/services/cecobrowsega/v1/customer/session/logout",SOCKETSERVICEURL:"/services/cecobrowsega/sockjs/cobrowse/customer"};a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";function b(b){this._agentCobrowseProvider=new a.Providers.Cobrowse.Agent.AgentCobrowseProvider,this._agentCobrowse=b,this._cobrowseConfig=null,this._agentCoBrowseDataSet=new a.Base.CobrowseDataSet,a.Services.Cobrowse.Agent.AgentCobrowseServiceData.apply(this),a.Base.Observable.apply(this)}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.updateData=function(a){var b=this.getAgentDataSet().coBrowseData;$.extend(b.coBrowseSessionInfo,a.acsResponse.coBrowseSessionInfo),$.extend(b.options,a.options),b.passPhrase=a.acsResponse.passPhrase,b.authKey=a.acsResponse.authKey,b.superVisor=a.acsResponse.superVisor,this.getAgentDataSet().updateDataset(b)},b.prototype.getAgentDataSet=function(){return this._agentCoBrowseDataSet},b.prototype.start=function(a){return this._cobrowseConfig=a,this._agentCobrowseProvider.start(this._cobrowseConfig)},b.prototype.startSocketConnection=function(){var b=this;if(b.getAgentDataSet().coBrowseData.redirectURL){var c=a.Providers.Cobrowse.Agent.AgentCobrowseURLProvider.SOCKETSERVICEURL+"/?affinity="+b.getAgentDataSet().coBrowseData.redirectURL;b._agentCobrowseProvider.startSocketConnection(c)}else b._agentCobrowseProvider.startSocketConnection()},b.prototype.stopSocketConnection=function(){this._agentCobrowseProvider.stopSocketConnection()},b.prototype.setIFrame=function(a){this._iframeDivID=a,this._iframeDivSelector="#"+this._iframeDivID},b.prototype.requestSession=function(b){var c=$.Deferred(),d=this,e=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(d.getAgentDataSet().coBrowseData=new a.Base.CobrowseData,d.updateData(b),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.resolve(d.getAgentDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))},f=function(a){d.onFailure(a,c)};return this._agentCobrowseProvider.requestSession(b).then(e,f),c.promise()},b.prototype.joinSession=function(b){var c=this,d=$.Deferred(),e=!0,f=function(a){c.onFailure(a,d)},g=function(h){if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&h.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var i=c.getAgentDataSet().coBrowseData;i.authKey=h.acsResponse,i.coBrowseSessionInfo.agtAuthCode=h.acsResponse,i.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEAGENTREADYTOCOBROWSESTATE,i.options=h.options,$.extend(c.getAgentDataSet().coBrowseData,i),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.openConnection(d)}else if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&e){e=!1,b.affinity=h.acsResponse;var j=c._agentCobrowse.createJoinSessionArguments();$.extend(j,b),c.getAgentDataSet().coBrowseData.redirectURL=h.acsResponse,$.extend(c.getAgentDataSet().coBrowseData.options,h.options),c._agentCobrowseProvider.joinSession(b).then(g,f)}else h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(h.errorCode,h.errorMessage,h.errorMessage))};return c._agentCobrowseProvider.joinSession(b).then(g,f),d.promise()},b.prototype.joinLiveSession=function(b){var c=this,d=$.Deferred(),e=!0,f=function(a){c.onFailure(a,d)},g=function(h){if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&h.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var i=c.getAgentDataSet().coBrowseData;i.authKey=h.acsResponse,i.passPhrase=b.sessionkey,i.coBrowseSessionInfo.agtAuthCode=h.acsResponse,i.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,i.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,i.coBrowseSessionInfo.passPhrase=b.sessionkey,i.coBrowseSessionInfo.agentName=b.name,i.options=h.options,$.extend(c.getAgentDataSet().coBrowseData,i),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,null),c.openConnection(),d.resolve(c.getAgentDataSet().coBrowseData.coBrowseSessionInfo)}else if(h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&e){e=!1,b.affinity=h.acsResponse;var j=c._agentCobrowse.createLiveJoinSessionArguments();$.extend(j,b),c.getAgentDataSet().coBrowseData.redirectURL=h.acsResponse,c._agentCobrowseProvider.joinLiveSession(b).then(g,f)}else h&&h.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(h.errorCode,h.errorMessage,h.errorMessage))};return c._agentCobrowseProvider.joinLiveSession(b).then(g,f),d.promise()},b.prototype.statusSession=function(b){var c=this;void 0===b&&(b=c._agentCobrowse.createStatusArguments()),b.acstoken=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode;var d=c.getAgentDataSet().coBrowseData.redirectURL;if(d&&""!==d){b.affinity=d;var e=c._agentCobrowse.createStatusArguments();$.extend(e,b)}this._retryCount<=this._retryAttemps?(b.acstoken||(b.acstoken=a.Base.CobrowseCookie.get("AGENT_ACS_TOKEN")),this._agentCobrowseProvider.statusSession(b).then(function(d){
if(c._connRetryTimer&&(a.Base.CobrowseLogger.warn("Connected to Server! Stop retrying...."),clearInterval(c._connRetryTimer),c._connRetryTimer=null,c._retryCount=0),d&&d.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&d.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var e=c.getAgentDataSet().coBrowseData;$.extend(e.coBrowseSessionInfo,d.acsResponse),$.extend(e.options,d.options),$.extend(c.getAgentDataSet().coBrowseData,e),c.openConnection(),c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE?(c.updateOnCtrlChg(!0),c.stopInactiveTimer()):c.updateOnCtrlChg(!1),c.onStart()}else d&&d.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&!b.affinity?(b.affinity=d.acsResponse,c.getAgentDataSet().coBrowseData.redirectURL=d.acsResponse,c.statusSession(b)):d.errorCode===a.Services.Cobrowse.Common.CobrowseConstants.NOAGENTSESSIONFOUNDSTATUSCODE?(c.shutdown(),c.onFail({isDisconnected:!0,isAgentSessionNotFound:!0})):c.onFail({isDisconnected:!0,isAgentSessionNotFound:!0})},function(b){a.Base.CobrowseLogger.warn(" Status called failed "+b),c.onFail({isDisconnected:!1,isAgentSessionNotFound:!1})})):(a.Base.CobrowseLogger.warn("Maximum reconnect attempts exceeded "),clearInterval(c._connRetryTimer),c._connRetryTimer=null,c.onFail({isDisconnected:!0}),c.stopInactiveTimer(),c._retryCount=0,c.shutdown())},b.prototype.logoutSession=function(b){var c=this,d=$.Deferred();void 0===b&&(b=c._agentCobrowse.createLogoutSessionArguments()),b.acstoken=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b.eurl=c.getCurrentURL();var e=c.getAgentDataSet().coBrowseData.redirectURL;e&&""!==e&&(b.affinity=e);var f=function(b){c._connRetryTimer&&(a.Base.CobrowseLogger.warn("Logout !! Clear Connection Retry timer.."),clearInterval(c._connRetryTimer),c._connRetryTimer=null),b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(d.resolve(c.getAgentDataSet().coBrowseData.coBrowseSessionInfo),c.shutdown(),c.getAgentDataSet().coBrowseData.redirectURL="",c.stopInactiveTimer()):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&d.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))},g=function(a){c.onFailure(a,d),c.getAgentDataSet().coBrowseData.redirectURL=""};return this._agentCobrowseProvider.logoutSession(b).then(f,g),d.promise()},b.prototype.openConnection=function(b){var c=this;if(!this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode)return void c.onFail({message:"Unable to open connection, token = "+c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode});this._agentCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN,function(d){a.Base.CobrowseLogger.info("openConnection::result"+d),c.rpcStartSession(b)}),c._agentCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,function(){c._connRetryTimer||(c._connRetryTimer=setInterval(function(){a.Base.CobrowseLogger.info("ConnectionClose:: retrying to connect again"),c.resetInactiveCounter(),c._retryCount++;var b=c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode;b||(b=a.Base.CobrowseCookie.get("AGENT_ACS_TOKEN")),c.shutdown(!1),a.Base.CobrowseCookie.set("AGENT_ACS_TOKEN",b,null),c.statusSession()},c._connRetryInterval))}),this.startSocketConnection()},b.prototype.onDemandUpdate=function(){$(this._iframeDivSelector).length>0&&$(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-wait"),this.rpcSyncAction({event:"refresh",type:"null",id:"null",cssSelector:"null",value:"null"})},b.prototype.rpcStartSession=function(b){var c,d=this;d._agentCobrowseProvider.callJsonRPC("agentservice","startSession",d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,"",d.getCurrentURL(),function(e){b&&b.resolve(d.getAgentDataSet().coBrowseData.coBrowseSessionInfo),a.Base.CobrowseLogger.info("startSession:: Session established"+e),d.startOnConnection(),d.rpcOnConnection(),d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEIDLESTATE&&!0===c&&d.onStart()},function(b){c=!1,a.Base.CobrowseLogger.error("startSession:: Session not established"+b),d.onFail.call(d)})},b.prototype.rpcRequestControl=function(){var b=$.Deferred(),c=function(c){a.Base.CobrowseLogger.info("RequestControl:: sent"+c),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE,b.resolve(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo)},d=function(c){b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),c.getMessage()))};return this._agentCobrowseProvider.sendJsonRPC("agentservice","requestControl",[this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,this.getCurrentURL()]).then(c.bind(this),d),b.promise()},b.prototype.rpcReleaseControl=function(){var b=$.Deferred(),c=function(c){a.Base.CobrowseLogger.info("ReleaseControl:: sent"+c),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,this.stopInactiveTimer(),this.updateOnCtrlChg(!0),b.resolve(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo)},d=function(b){a.Base.CobrowseLogger.error("releaseControl:: Unable to reach customer"+b.data)};return this._agentCobrowseProvider.sendJsonRPC("agentservice","releaseControl",[this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,this.getCurrentURL()]).then(c.bind(this),d),b.promise()},b.prototype.rpcSendChatMsg=function(){var b=this;b._agentCobrowseProvider.callJsonRPC("agentservice","sendChatMsg",b.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b.getCurrentURL(),function(b){a.Base.CobrowseLogger.info("sendChatMsg:: sent"+b)},function(b){a.Base.CobrowseLogger.error("sendChatMsg:: Unable to reach customer"+b)})},b.prototype.rpcOnConnection=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","onConnection",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,"",function(b){a.Base.CobrowseLogger.info("onConnection:: onConnection send to customer: "+b)},function(b){a.Base.CobrowseLogger.warn("notifyCustomer:: Unable to send noftify Customer"+b)})},b.prototype.rpcGetNextUpdate=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","getNextUpdate",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,function(b){a.Base.CobrowseLogger.info("doGetNextUpdate:: sent"+b)},function(b){a.Base.CobrowseLogger.error("doGetNextUpdate:: Unable to reach customer"+b.data)})},b.prototype.rpcSyncAction=function(b){this._agentCobrowseProvider.callJsonRPC("agentservice","syncAction",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,b,function(b){a.Base.CobrowseLogger.info("syncAction:: sent"+b)},function(b){a.Base.CobrowseLogger.error("syncAction:: Unable to reach customer"+b.data)})},b.prototype.rpcSendMousePos=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","sendMousePos",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,{event:"mousemove",mX:this._mX,mY:this._mY,id:this._mNodeId,cssSelector:this._mNodeCss})},b.prototype.rpcSendScrollPos=function(a){this._agentCobrowseProvider.callJsonRPC("agentservice","sendScrollPos",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,{event:"scroll",scrollTop:a.scrollTop,scrollLeft:a.scrollLeft})},b.prototype.rpcSendAgentAction=function(){this._agentCobrowseProvider.callJsonRPC("agentservice","sendAgentActionToACustomer",this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,actionObj,function(b){a.Base.CobrowseLogger.info("sendAgentAction:: sent"+b)},function(b){a.Base.CobrowseLogger.error("sendAgentAction:: Unable to reach customer"+b)})},b.prototype.rpcOnMouseSel=function(){var b=this.getTextRange(),c=this;c._agentCobrowseProvider.callJsonRPC("agentservice","onMouseSel",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,{event:"mouseselect",mhighlightText:b},function(b){a.Base.CobrowseLogger.info("Mouse selected"+b),c.resetInactiveCounter()},function(b){a.Base.CobrowseLogger.warn("error while sending mouse select: "+b)})},b.prototype.rpcUpdateIdleTime=function(b){var c=this,d=b+60*c.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"];c._agentCobrowseProvider.callJsonRPC("agentservice","inactiveTime",c.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agtAuthCode,d,c.getCurrentURL(),function(b){a.Base.CobrowseLogger.info("inactiveTime:: sent"+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.registerJsonRPCCallbacks=function(){this._agentCobrowseProvider.registerServerCallback("onMouseUpdate",this.onMouseUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onScrollUpdate",this.onScrollUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onViewUpdate",this.onViewUpdateCallBack,this),this._agentCobrowseProvider.registerServerCallback("onStateChange",this.onStateChangeCallBack,this),this._agentCobrowseProvider.registerServerCallback("onChatMsg",this.onChatMsgCallBack,this),this._agentCobrowseProvider.registerServerCallback("onSessionClosed",this.onSessionClosedCallBack,this),this._agentCobrowseProvider.registerServerCallback("onSessionTimeout",this.onSessionTimeoutCallBack,this),this._agentCobrowseProvider.registerServerCallback("onCustomerJoin",this.onCustomerJoinCallBack,this),this._agentCobrowseProvider.registerServerCallback("heartBeat",this.heartBeatCallBack,this),this._agentCobrowseProvider.registerServerCallback("onMouseSel",this.onMouseSelCallBack,this),this._agentCobrowseProvider.registerServerCallback("inactiveTime",this.inactiveTimeCallBack,this),this._agentCobrowseProvider.registerServerCallback("customerMovedAway",this.customerMovedAwayCallBack,this)},b.prototype.getCurrentURL=function(){return encodeURI(Base64.encode(window.location.href))},b.prototype.onStart=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},b.prototype.onFail=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},b.prototype.onSessionClose=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},b.prototype.onSessionTimeout=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_TIMEOUT)},b.prototype.onControlGrant=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT)},b.prototype.onControlDenial=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL)},b.prototype.onControlRevoke=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE)},b.prototype.onCustomerJoin=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN)},b.prototype.onViewUpdate=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_VIEW_UPDATE)},b.prototype.onPause=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE)},b.prototype.onResume=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME)},b.prototype.onCustomerDead=function(){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD)},b.prototype.onInActivityTimerOccured=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},b.prototype.onStopInActivityTimerOccured=function(b){this.trigger(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},b.prototype.onFailure=function(b,c){var d=b.getMessage();a.Base.CobrowseLogger.error(b.getReason(),d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},a.Services.Cobrowse.Agent.AgentCobrowseService=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._iframeDivID=void 0,this._iframeDivSelector=void 0,this._iframeDiv=void 0,this._iframe=void 0,this._iframeBody=void 0,this._mPtr=void 0,this._mYr=100,this._mXr=100,this._mask=void 0,this._expectScrollUpdate=!1,this._mNodeCss=void 0,this._mNodeId=void 0,this._mNodeEvt=void 0,this._mLocalNode=void 0,this._mNodeCssOld=void 0,this._mY=0,this._mYO=0,this._mX=0,this._mXO=0,this._mmSyncInterval=1e3,this._mmSyncTimer=void 0,this._inactiveCounter=120,this._inactiveInterval=5e3,this._inactivityMessage="",this._scrollTopOld=0,this._scrollLeftOld=0,this._connRetryInterval=1e4,this._connRetryTimer=null,this._retryAttemps=10,this._retryCount=0}a.Services.Cobrowse.Agent.AgentCobrowseServiceData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";var c={startOnConnection:function(){this.registerJsonRPCCallbacks(),this._iframeDiv=b(this._iframeDivSelector),b(this._iframeDivSelector).length>0&&(this._iframe=b(this._iframeDivSelector).contents(),this._iframeBody=this._iframe.find("body"),this._iframeBody.append(this.getPtr()))},getPtr:function(){return this._mPtr=b('<div id="cbePtr" class="cbe-remote-cursor"></div>').css({top:this._mYr,left:this._mXr}),this._mPtr},getReadOnlyMask:function(){return this._mask=b('<div id="cbeMask" class="cbe-readonly-mask"></div>'),this._mask},handleEvtForNode:function(c,d){var e=this;try{if((this._mNodeCss!==c.getPath()||this._mNodeId!==c.attr("id")||this._mNodeEvt!==d)&&(this._mNodeCss=c.getPath(),this._mNodeId=c.attr("id"),this._mNodeEvt=d,c.is("li")||c.is("a")||c.is("div"))){var f=c.attr("type"),g=c.value,h={event:d,id:this._mNodeId,cssSelector:this._mNodeCss,type:f,value:g};e.rpcSyncAction(h),b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait")}}catch(i){a.Base.CobrowseLogger.warn("handleEvtForNode: Failed "+i)}},onViewUpdateCallBack:function(b){this.onViewUpdate(),a.Base.CobrowseLogger.info("////////////////////////////// View Update received //////////////////////////////////////"),this.processViewUpdate(b),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&this.rpcGetNextUpdate()},onStateChangeCallBack:function(c){var d=this.getAgentDataSet().coBrowseData;switch(c){case"Pause":d.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onPause();break;case"resume":d.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onResume();break;case"grant":d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onControlGrant(),this.updateOnCtrlChg(!1),this.startInactiveTimer();break;case"deny":d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.onControlDenial();break;case"revoke":this.onControlRevoke(),d.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.extend(this.getAgentDataSet().coBrowseData,d),this.updateOnCtrlChg(!0),this.stopInactiveTimer();break;default:a.Base.CobrowseLogger.error("onStateChange: Unknown State")}},onChatMsgCallBack:function(){},onSessionClosedCallBack:function(a){this.stopInactiveTimer(),this.shutdown(),this.onSessionClose({msg:a})},onSessionTimeoutCallBack:function(){this.onSessionTimeout()},onCustomerJoinCallBack:function(b){null!==b||void 0!==b?(a.Base.CobrowseLogger.info("onCustomerJoin: ["+b.customerName+","+b.cobrowseState+","+b.agentControlState+"]"),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState=b.cobrowseState,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode=b.custAuthCode,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custSessionTransferInProgress=b.custSessionTransferInProgress,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.custUserAgent=b.custUserAgent,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.customerName=b.customerName,this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState=b.agentControlState,this.onCustomerJoin()):a.Base.CobrowseLogger.error("onCustomerJoin: "+e[0])},heartBeatCallBack:function(){},inactiveTimeCallBack:function(){},customerMovedAwayCallBack:function(){this.onCustomerDead()},processViewUpdate:function(c){var d=c.data,e=c.cssData,f=c.windowSize,g=c.scrollPosition;if(0===b(this._iframeDivSelector).length)return void a.Base.CobrowseLogger.info("IFrame not found");if(e){b(this._iframeDivSelector).contents().find("head").empty(),b(this._iframeDivSelector).contents().find("head").html(Base64.decode(e));var h=b('<link id="cbeCSS" type="text/css" rel="stylesheet" href="css/agent.css"/>');b(this._iframeDivSelector).contents().find("head").append(h)}else a.Base.CobrowseLogger.info("No head section update!");if(d){if(b(this._iframeDivSelector).contents().find("body").empty(),b(this._iframeDivSelector).contents().find("body").html(Base64.decode(d)),b(this._iframeDivSelector).contents().find("textarea").each(function(){try{var a=b(this).attr("scrollTop");b(this).scrollTop(a)}catch(c){}}),b(this._iframeDivSelector).contents().find("body").append(this.getPtr()),b(this._iframeDivSelector).contents().find("body").append(this.getReadOnlyMask()),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE?(this._mPtr.hide(),this._mask.hide(),this.startTracker(),b(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-wait")):(this._mPtr.show(),this._mask.show(),b(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-wait").removeClass("cbe-cursor-allowed").addClass("cbe-cursor-not-allowed")),f){var i=JSON.parse(f);i.w>b(window).width()?(b(this._iframeDivSelector).css({width:b(window).width()}),this._mask.css({width:b(window).width()}),b("#cbeCustScreen").show()):(b(this._iframeDivSelector).css({width:i.w}),this._mask.css({width:i.w}),b("#cbeCustScreen").hide()),i.h>b(window).height()-60?(b(this._iframeDivSelector).css({height:b(window).height()-60}),this._mask.css({height:b(this._iframeDivSelector).contents().height()}),b("#cbeCustScreen").show()):(b(this._iframeDivSelector).css({height:i.h+15}),this._mask.css({height:b(this._iframeDivSelector).contents().height()}),b("#cbeCustScreen").hide())}g&&(b(this._iframeDivSelector)[0].contentWindow.scrollTo(JSON.parse(g).scrollX,JSON.parse(g).scrollY),this._expectScrollUpdate=!1),a.Base.CobrowseLogger.info("View Update Complete: "+new Date),this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(b(this._iframeDivSelector).contents().find("body").find("input").bind("keydown",this.disableTabControl),b(this._iframeDivSelector).contents().find("body").find("a").bind("keydown",this.disableTabControl))}else a.Base.CobrowseLogger.warn("No Update Received from Customer! - Clearing the view")},disableTabControl:function(b){9===b.keyCode&&(a.Base.CobrowseLogger.log("Event tab recieved, killing it"),b.preventDefault())},shutdown:function(c){var d=c;"boolean"!=typeof d&&(d=!0),this.getAgentDataSet().coBrowseData=new a.Base.CobrowseData,this.stopSocketConnection(),this.updateOnCtrlChg(!0),d&&(b(this._iframeDivSelector).length>0&&(b(this._iframeDivSelector).empty(),b(this._iframeDivSelector).contents().find("body").empty()),this._connRetryTimer&&(clearInterval(this._connRetryTimer),this._connRetryTimer=null),this._retryCount=0),this._mmSyncTimer&&(clearInterval(this._mmSyncTimer),this._mmSyncTimer=null),this.stopInactiveTimer(),a.Base.CobrowseCookie.erase("AGENT_ACS_TOKEN")},updateOnCtrlChg:function(a){a?(b(this._iframeDivSelector).length>0&&(b(this._iframeDivSelector).contents().find("body").append(this.getReadOnlyMask().show()),b(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-wait").removeClass("cbe-cursor-allowed").addClass("cbe-cursor-not-allowed")),this.enableMouseSync(!1),this.stopTracker()):(this._mPtr.remove(),this._mask.remove(),b(this._iframeDivSelector).contents().find("body").removeClass("cbe-cursor-not-allowed").addClass("cbe-cursor-allowed"),this.startTracker(),this.enableMouseSync(!0),b(this._iframeDivSelector).contents().find("body").find("input").unbind("keydown",this.disableTabControl),b(this._iframeDivSelector).contents().find("body").find("a").unbind("keydown",this.disableTabControl))},startInactiveTimer:function(){this.resetInactiveCounter(),a.Base.CobrowseLogger.info("START INACTIVE TIMER START FOR AGENT "),null!==this._inactiveTimer&&clearInterval(this._inactiveTimer);var b=this;this._inactiveTimer=setInterval(function(){b.incInactiveCounter(),b._inactiveCounter>60*b.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"]&&(b.onInActivityTimerOccured(b.getAgentDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT_MESSAGE"]),a.Base.CobrowseLogger.info("fire _onCobrowseRequestSuccessCallbacks "),b.resetInactiveCounter())},b._inactiveInterval)},stopInactiveTimer:function(){a.Base.CobrowseLogger.info(" STOP INACTIVE TIMER ");var b=this;null!==b._inactiveTimer&&(clearInterval(b._inactiveTimer),b.onStopInActivityTimerOccured(b.getAgentDataSet().coBrowseData.options["CB.STOP_INACTIVE_TIMEOUT_MESSAGE"])),b.resetInactiveCounter()},resetInactiveCounter:function(){this._inactiveCounter=0,a.Base.CobrowseLogger.info("RESET COUNTER  "+this._inactiveCounter)},incInactiveCounter:function(){a.Base.CobrowseLogger.info("Increment Inactive Counter "+this._inactiveCounter),this._inactiveCounter=this._inactiveCounter+5}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(b){this._cobrowseConfig=b,this._agentCobrowseService=new a.Services.Cobrowse.Agent.AgentCobrowseService(this),this._coBrowseCapability=new a.Base.CoBrowseCapability(a.Base.CobrowseCapabilityDenialReason.CAPABILITY_INVALID_STATE)}c.prototype={start:function(){if(!this._cobrowseConfig){var c=b.Deferred();return c.reject("Cobrowse configuration is not defined."),c.promise()}return this._agentCobrowseService.start(this._cobrowseConfig).then(function(b){return this._coBrowseCapability._updateIfChanged(!0,a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED),a.Base.CobrowseLogger.info("Successfully initialized cobrowse service"),b}.bind(this),function(b){a.Base.CobrowseLogger.error(b)})},getAgentData:function(){return this._agentCobrowseService.getAgentDataSet()&&this._agentCobrowseService.getAgentDataSet().coBrowseData?this._agentCobrowseService.getAgentDataSet().coBrowseData.coBrowseSessionInfo:new a.Base.CobrowseSessionInfo},requestSession:function(a,b,c){return this._agentCobrowseService.requestSession({name:a,locale:b,emailid:c})},joinSession:function(a){return this._agentCobrowseService.joinSession({acstoken:a})},joinLiveSession:function(a,b,c){return this._agentCobrowseService.joinLiveSession({name:a,sessionkey:b,emailid:c})},logoutSession:function(a){return this._agentCobrowseService.logoutSession({reason:a})},requestControl:function(){return this._agentCobrowseService.rpcRequestControl()},onDemandUpdate:function(){return this._agentCobrowseService.onDemandUpdate()},releaseControl:function(){return this._agentCobrowseService.rpcReleaseControl()},updateIdleTime:function(a){this._agentCobrowseService.rpcUpdateIdleTime(a)},setIFrame:function(a){this._agentCobrowseService.setIFrame(a)}},a.Services.Cobrowse.Agent.AgentCobrowse=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={EVENT_ON_ONREADY:"cbprovider.onReady",EVENT_ON_START:"cbprovider.onStart",EVENT_ON_FAIL:"cbprovider.onFail",EVENT_ON_JOINLIVESESSIONFAIL:"cbprovider.onJoinLiveSessionFail",EVENT_ON_JOINLIVESESSIONSUCCESS:"cbprovider.onJoinLiveSessionSuccess",EVENT_ON_SESSION_CLOSE:"cbprovider.onSessionClose",EVENT_ON_SESSION_TIMEOUT:"cbprovider.onSessionTimeout",EVENT_ON_CONTROL_GRANT:"cbprovider.onControlGrant",EVENT_ON_CONTROL_DENIAL:"cbprovider.onControlDenial",EVENT_ON_CONTROL_REVOKE:"cbprovider.onControlRevoke",EVENT_ON_CUSTOMER_JOIN:"cbprovider.onCustomerJoin",EVENT_ON_PAUSE:"cbprovider.onPause",EVENT_ON_RESUME:"cbprovider.onResume",EVENT_ON_CUSTOMER_DEAD:"cbprovider.onCustomerDead",EVENT_ON_INACTIVITY_TIMEOUT:"cbprovider.onInactivityTimeout",EVENT_ON_STOPINACTIVITY_TIMEOUT:"cbprovider.onStopInactivityTimeout"};a.Services.Cobrowse.Agent.ObservableAgentEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={LANGUAGE_ENGLISH:"en_US",LANGUAGE_DEUTSCH:"de",LANGUAGE_FRENCH:"fr",LANGUAGE_CHINESE:"zh_CN",LANGUAGE_SPANISH:"es",LANGUAGE_ITALIAN:"it",LANGUAGE_JAPANESE:"ja",LANGUAGE_KOREAN:"ko",LANGUAGE_PORTUGUESE:"pt_BR",LANGUAGE_RUSSIAN:"ru"};a.Services.Cobrowse.LocaleField=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={AGENTCONTROLTRUESTATE:"true",AGENTCONTROLFALSESTATE:"false",AGENTCONTROLPENDINGSTATE:"pending",AGENTCONTROLEXPIREDSTATE:"expired"};a.Services.Cobrowse.Common.AgentControlState=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={COBROWSEAGENTREADYTOCOBROWSESTATE:"Waiting for Customer",COBROWSECUSTOMERREADYTOCOBROWSESTATE:"Waiting for Agent",COBROWSEINPROGRESSSTATE:"InProgress",COBROWSEIDLESTATE:"Idle",COBROWSEAWAYSTATE:"Away",COBROWSEPAUSEDSTATE:"Paused"};a.Services.Cobrowse.Common.CobrowseState=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a){"use strict";var b={SUCCESSSTATUSCODE:"200",FAILSTATUSCODE:"500",REDIRECTSTATUSCODE:"302",NOSESSIONFOUNDSTATUSCODE:"1002",NOAGENTSESSIONFOUNDSTATUSCODE:"1001",SUCCESSRESULT:"success",CUSTOMERSERVICE:"customerservice",ONGETNEXTUPDATE:"onGetNextUpdate",ONCONTROLREQUEST:"onControlRequest",ONCONTROLRELEASE:"onControlRelease",ONREMOTEACTION:"onRemoteAction",ONSESSIONCLOSED:"onSessionClosed",ONMOUSEUPDATE:"onMouseUpdate",ONSCROLLUPDATE:"onScrollUpdate",ONAGENTJOIN:"onAgentJoin",ONMOUSESEL:"onMouseSel",INACTIVETIME:"inactiveTime",AGENTMOVEDAWAY:"agentMovedAway",AGENTONMOUSEUPDATE:"onMouseUpdate",AGENTONSCROLLUPDATE:"onScrollUpdate",AGENTONVIEWUPDATE:"onViewUpdate",AGENTONSTATECHANGE:"onStateChange",AGENTONCHATMSG:"onChatMsg",AGENTONSESSIONCLOSED:"onSessionClosed",AGENTONSESSIONTIMEOUT:"onSessionTimeout",AGENTONCUSTOMERJOIN:"onCustomerJoin",AGENTHEARTBEAT:"heartBeat",AGENTONMOUSESEL:"onMouseSel",AGENTINACTIVETIME:"inactiveTime",AGENTCUSTOMERMOVEDAWAY:"customerMovedAway"};a.Services.Cobrowse.Common.CobrowseConstants=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";function c(a,b){this._coBrowseUtility=a,this._coBrowseHtmlData=b,this._html5tags=["nav","header","footer","abbr","article","aside","audio","canvas","command","datalist","details","figure","figcaption","hgroup","keygen","mark","meter","output","progress","section","source","summary","time","video"],this._enableDataMasking=!0}c.prototype={_createInputField:function(){this._coBrowseHtmlData.find("input").each(function(){try{var a=b(this).attr("type");if("checkbox"===a)b(this).attr("checked",this.checked);else if("radio"===a){var c=b(b(this).getPath()).is(":checked");c?b(this).attr("checked",!0):b(this).attr("checked",!1)}else b(this).attr("value",b(this).val())}catch(d){}})},_createSelectBox:function(){this._coBrowseHtmlData.find("select").each(function(){try{b(this).children().get(b(b(this).getPath()).get(0).selectedIndex).setAttribute("selected",!0)}catch(a){}})},_createTextArea:function(){this._coBrowseHtmlData.find("textarea").each(function(){try{b(this).html(b(b(this).getPath()).val()),b(this).attr("scrollTop",b(b(this).getPath()).scrollTop())}catch(a){}})},_createDataMaskingFields:function(){this._enableDataMasking&&(this._coBrowseHtmlData.find(".avcobrowse-mask").each(function(){try{b(this).val().length>0?(b(this).attr("value","*********"),b(this).is("textarea")&&b(this).html("*********")):b(this).attr("value",""),b(this).attr("disabled","disabled").addClass("cbe-mask-text").attr("title","You are not allowed to view or modify this.")}catch(a){}}),this._coBrowseHtmlData.find(".avcobrowse-block").each(function(){try{b(this).attr("disabled","disabled"),b(this).attr("title","You are not allowed to perform any action on this element"),b(this).is("button")?b(this).addClass("cbe-block-btn"):b(this).is("input")&&"checkbox"===this.type&&b(this).addClass("cbe-block-chkbox")}catch(a){}}))},_createImages:function(){var c=this;this._coBrowseHtmlData.find("img").each(function(){try{var d,e=b(this).attr("src");e?0===e.indexOf("//")?(d=window.location.protocol+e,b(this).attr("src",d)):0===e.indexOf("/")?(d=c._coBrowseUtility.getDomainURL()+e,b(this).attr("src",d)):0!==e.indexOf("http")&&(d=c._coBrowseUtility.getBaseURL()+e,b(this).attr("src",d)):a.Base.CobrowseLogger.debug("WARNING: Check src attribute for <img> tag")}catch(f){}})},_createLinks:function(){var a=this;this._coBrowseHtmlData.find("link").each(function(){try{var c,d=b(this).attr("href"),e=b(this).attr("rel");"stylesheet"===e?d&&(0===d.indexOf("//")?(c=window.location.protocol+d,b(this).attr("href",c)):0===d.indexOf("/")?(c=a._coBrowseUtility.getDomainURL()+d,b(this).attr("href",c)):0===d.indexOf("http")&&0===d.indexOf("https")||(c=a._coBrowseUtility.getBaseURL()+d,b(this).attr("href",c))):b(this).remove()}catch(f){}})},_doRemoveKnownHTML:function(){this._coBrowseHtmlData.find("#cbeMask").remove(),this._coBrowseHtmlData.find("#cbePtr").remove(),this._coBrowseHtmlData.find("#cbeHighlightId").remove(),this._coBrowseHtmlData.find(".cbe-mask-help").remove(),this._coBrowseHtmlData.find(".cbe-block-help").remove(),this._coBrowseHtmlData.find(".avcobrowse-hide").remove()},_doRemoveUnwantedHTML:function(){var c=this;b.each(c._coBrowseUtility._removeElementList,function(b,d){a.Base.CobrowseLogger.debug("Removing element=>"+b+":"+d),c._coBrowseHtmlData.find("#"+d).remove()})},_doRemoveScript:function(){this._coBrowseHtmlData.find("script").remove()},_doCreateHtml5Tag:function(){if(-1!==navigator.appName.indexOf("Internet Explorer")&&-1!==navigator.appVersion.indexOf("MSIE 8"))for(var b=0;b<this._html5tags.length;b++)try{htmlBody.find(html5tags[b]).replaceWith(this._changeHtml5Tag(html5tags[b]))}catch(c){a.Base.CobrowseLogger.error("Exception in cloning HTML5 tags in IE8 at the tag "+b+" "+c)}},_changeHtml5Tag:function(a){var c=a,d="";b.each(c.attributes,function(a,b){var c=b.name,e=b.value;d=" "+c+'="'+e+'"'});var e="<"+b(c).prop("tagName")+d+">"+b(c).html()+"</"+b(c).prop("tagName")+">";return b(e)},getHtmlBody:function(){return this._coBrowseHtmlData},updateHtmlBody:function(){return this._createInputField(),this._createSelectBox(),this._createTextArea(),this._createDataMaskingFields(),this._createImages(),this._createLinks(),this._doRemoveKnownHTML(),this._doRemoveUnwantedHTML(),this._doRemoveScript(),this._doCreateHtml5Tag(),this._coBrowseHtmlData}},a.Services.Cobrowse.Customer.CustomerCobrowseHtmlBody=c}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";function c(a,b){this._coBrowseUtility=a,this._coBrowseHtmlHead=b,this._updatedHtmlHead=""}c.prototype={_createLink:function(){var c=this;try{this._coBrowseHtmlHead.find("link").each(function(){if("cbeCSS"!==b(this).attr("id")){
var a=b(this).attr("href"),d=b(this).attr("rel");if("stylesheet"===d.toLowerCase()){var e='<link rel="'+d+'"',f=a;a&&(0===a.indexOf("//")?f=window.location.protocol+a:0===a.indexOf("/")?f=c._coBrowseUtility.getDomainURL()+a:0!==a.indexOf("http")&&(f=c._coBrowseUtility.getBaseURL()+a));var g="";b.each(this.attributes,function(a,b){var c=b.name,d=b.value;"href"!==c&&"rel"!==c&&(g=" "+c+'="'+d+'"')}),e+=g+' href="'+f+'" />',c._updatedHtmlHead+=e}}})}catch(d){a.Base.CobrowseLogger.error("Exception in head cloning link: "+d)}},_createTitleandStyle:function(){var c=this;try{this._coBrowseHtmlHead.find("title, style").each(function(){var a=b(this).prop("tagName").toLowerCase(),d="";b.each(this.attributes,function(a,b){var c=b.name,e=b.value;d=" "+c+'="'+e+'"'});var e=b(this).html();c._updatedHtmlHead+="<"+a+d+">"+e+"</"+a+">"})}catch(d){a.Base.CobrowseLogger.error("Exception in head cloning title and style: "+d)}},getHtmlHead:function(){return this._updatedHtmlHead},updateHtmlHead:function(){return this._createLink(),this._createTitleandStyle(),this._updatedHtmlHead?this._updatedHtmlHead="<head>"+this._updatedHtmlHead+"</head>":this._updatedHtmlHead="<head></head>",this._updatedHtmlHead}},a.Services.Cobrowse.Customer.CustomerCobrowseHtmlHead=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";function b(b){this._customerCobrowse=b,this._customerCobrowseProvider=new a.Providers.Cobrowse.Customer.CustomerCobrowseProvider,this._cobrowseConfig=null,this._coBrowseDataSet=new a.Base.CobrowseDataSet,a.Base.Observable.apply(this),a.Services.Cobrowse.Customer.CustomerCobrowseServiceData.apply(this)}function c(){return encodeURI(Base64.encode(window.location.href))}b.prototype=Object.create(a.Base.Observable.prototype),b.prototype.updateData=function(a){var b=this.getCustomerDataSet().coBrowseData;$.extend(b.coBrowseSessionInfo,a.acsResponse.coBrowseSessionInfo),$.extend(b.options,a.options),b.passPhrase=a.acsResponse.passPhrase,b.authKey=a.acsResponse.authKey,b.superVisor=a.acsResponse.superVisor,this.getCustomerDataSet().updateDataset(b)},b.prototype.getCustomerDataSet=function(){return this._coBrowseDataSet},b.prototype.init=function(a){return this._cobrowseConfig=a,this._customerCobrowseProvider.init(this._cobrowseConfig)},b.prototype.startSocketConnection=function(){this._customerCobrowseProvider.startSocketConnection()},b.prototype.requestSession=function(b){this._isAgentJoined=!1;var c=$.Deferred();b.eurl=this.getCurrentURL();var d=this._customerCobrowse.createRequestSessionArguments();$.extend(d,b);var e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to request a session=>",d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(this.getCustomerDataSet().coBrowseData=new a.Base.CobrowseData,this.updateData(b),a.Base.CobrowseCookie.set("ACS_TOKEN",this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,null),this.openConnection(),c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&(a.Base.CobrowseLogger.error("Failed to request a session",b.errorMessage),c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage)))};return this._customerCobrowseProvider.requestSession(b).then(f.bind(this),e),c.promise()},b.prototype.joinSession=function(b){var c=$.Deferred(),d=!0,e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to join a session",d),c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(g){if(g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&g.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT)$.extend(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,g.acsResponse),$.extend(this.getCustomerDataSet().coBrowseData.options,g.options),this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,a.Base.CobrowseCookie.set("ACS_TOKEN",this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,null),this.openConnection(),c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo);else if(g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&d){d=!1,b.affinity=g.acsResponse;var h=this._customerCobrowse.createJoinSessionArguments();$.extend(h,b),this.getCustomerDataSet().coBrowseData.redirectURL=g.acsResponse,this._customerCobrowseProvider.joinSession(b).then(f.bind(this),e)}else g&&g.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(g.errorCode,"Unable to Join Session ("+g.errorMessage+")",g.errorMessage))};return this._customerCobrowseProvider.joinSession(b).then(f.bind(this),e),c.promise()},b.prototype.statusSession=function(b){var c=this,d=a.Base.CobrowseCookie.get("ACS_TOKEN");this._md5_h=a.Base.CobrowseCookie.get("ACS_data_hmd5");var e;if(b?e=b:(e=c._customerCobrowse.createStatusArguments(),e.acstoken=d),!d)return c.shutdown(),void c.onReady({msg:"no active session found"});this._customerCobrowseProvider.statusSession(e).then(function(b){if(c._connRetryTimer&&(a.Base.CobrowseLogger.warn("Connected to Server! Stop retrying...."),clearInterval(c._connRetryTimer),c._connRetryTimer=null),b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT){var d=c.getCustomerDataSet().coBrowseData;$.extend(d.coBrowseSessionInfo,b.acsResponse),$.extend(d.options,b.options),c.getCustomerDataSet().updateDataset(d),d.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE&&(c._ctrlReqPending=!0),c.onReady({resume:!0,msg:"Reconnecting...."}),c.openConnection()}else b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.REDIRECTSTATUSCODE&&!e.affinity?(e.affinity=b.acsResponse,c.getCustomerDataSet().coBrowseData.redirectURL=b.acsResponse,c.statusSession(e)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.NOSESSIONFOUNDSTATUSCODE?(c.shutdown(),c.onReady({msg:"no active session found"})):c.onReady({resume:!1,msg:"no active session found"})},function(b){c._connRetryTimer?c.onFail({msg:"Conn Err! Retrying.."}):(a.Base.CobrowseLogger.warn("init (error): "+JSON.stringify(b)),c.onReady({resume:!1,msg:"no active session found"}))})},b.prototype.logoutSession=function(b){var c=$.Deferred();this._connRetryTimer&&(clearInterval(this._connRetryTimer),this._connRetryTimer=null),void 0===b&&(b=this._customerCobrowse.createLogoutSessionArguments()),b.acstoken=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode,b.eurl=this.getCurrentURL();var d=this.getCustomerDataSet().coBrowseData.redirectURL;d&&""!==d&&(b.affinity=d);var e=function(b){var d=b.getMessage();a.Base.CobrowseLogger.error("Failed to logout a session",d),this.getCustomerDataSet().coBrowseData.redirectURL="",c.reject(new a.Base.CoBrowseError(b.getErrorCode(),b.getReason(),d))},f=function(b){b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSSTATUSCODE&&b.acsResult===a.Services.Cobrowse.Common.CobrowseConstants.SUCCESSRESULT?(this.shutdown(),this.getCustomerDataSet().coBrowseData.redirectURL="",c.resolve(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo)):b&&b.statusCode===a.Services.Cobrowse.Common.CobrowseConstants.FAILSTATUSCODE&&c.reject(new a.Base.CoBrowseError(b.errorCode,b.errorMessage,b.errorMessage))};return this._customerCobrowseProvider.logoutSession(b).then(f.bind(this),e.bind(this)),c.promise()},b.prototype.onReady=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},b.prototype.onFail=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},b.prototype.onStart=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},b.prototype.onControlRequest=function(b){this._ctrlReqPending?a.Base.CobrowseLogger.warn("Old request is still pending."):(a.Base.CobrowseLogger.info("onControlRequest: Agent wish to control the web page"),this._ctrlReqPending=!0,this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b))},b.prototype.onControlRelease=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},b.prototype.onSessionClose=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},b.prototype.onAgentJoin=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},b.prototype.onAgentAlive=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTLIVE,b)},b.prototype.onAgentDead=function(b){this.trigger(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},b.prototype.rpcPause=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to pause a session",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.debug("changeState to pause:: success: "+c),d.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE,e.enableMouseSync.call(e,!1),e.stopViewSync.call(e),e.stopInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","changeState",[d.custAuthCode,"Pause",c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcResume=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to resume a session",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.debug("changeState to resume:: success: "+c),d.cobrowseState=a.Services.Cobrowse.Common.CobrowseState.COBROWSEINPROGRESSSTATE,e.enableMouseSync.call(e,!0),e.startViewSync.call(e,!1),e.startInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","changeState",[d.custAuthCode,"resume",c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcUpdateIdleTime=function(b){var d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=b+60*e.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"];e._customerCobrowseProvider.callJsonRPC("customerservice","inactiveTime",d.custAuthCode,f,c(),function(b){a.Base.CobrowseLogger.info("inactiveTime:: sent"+f+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.rpcGrantControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to grant control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},f=function(c){a.Base.CobrowseLogger.debug("grantControl:: success: "+c),this._ctrlReqPending=!1,this.cleanHighlightedNode(),this.startViewSync.call(this,!1),d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE,document.activeElement.blur(),this.enableMouseSync(!1),this.stopViewSync(),a.Base.CobrowseLogger.info("[grantControl: Inner function] -- _agentControl: "+d.agentControlState),this._updateOnCtrlChg(!0),this.stopInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","grantControl",[d.custAuthCode,!0,c()]).then(f.bind(this),e),b.promise()},b.prototype.rpcDenyControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to deny control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},f=function(c){a.Base.CobrowseLogger.debug("denyControl:: success: "+c),this._ctrlReqPending=!1,d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","grantControl",[d.custAuthCode,!1,c()]).then(f.bind(this),e),b.promise()},b.prototype.rpcRevokeControl=function(){var b=$.Deferred(),d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,e=this,f=function(c){var d=c.getMessage();a.Base.CobrowseLogger.error("Failed to revoke control",d),b.reject(new a.Base.CoBrowseError(c.getErrorCode(),c.getReason(),d))},g=function(c){a.Base.CobrowseLogger.debug("revokeControl:: success: "+c),d.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,e.enableMouseSync(!0),e.cleanHighlightedNode(),e.startViewSync.call(e,!1),e._updateOnCtrlChg(!1),e.startInactiveTimer(),b.resolve()};return this._customerCobrowseProvider.sendJsonRPC("customerservice","revokeControl",[d.custAuthCode,c()]).then(g.bind(this),f),b.promise()},b.prototype.rpcInactiveTime=function(b){var d=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;this._customerCobrowseProvider.callJsonRPC("customerservice","inactiveTime",d.custAuthCode,b,c(),function(b){a.Base.CobrowseLogger.debug("inactiveTime:: sent"+b)},function(b){a.Base.CobrowseLogger.error("inactiveTime:: Unable to update in audit log"+b)})},b.prototype.rpcSendMousePos=function(a){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;c.resetInactiveCounter(),c._customerCobrowseProvider.callJsonRPC("customerservice","sendMousePos",b.custAuthCode,a)},b.prototype.rpcSendScrollPos=function(a){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;c.resetInactiveCounter(),c._customerCobrowseProvider.callJsonRPC("customerservice","sendScrollPos",b.custAuthCode,a)},b.prototype.rpcSendViewUpdate=function(b){var c=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;this._customerCobrowseProvider.callJsonRPC("customerservice","sendViewUpdate",c.custAuthCode,b,function(b){a.Base.CobrowseLogger.info("////////////////////////////// View Update sent //////////////////////////////////////"+b)},function(b){a.Base.CobrowseLogger.warn("////////////////////////////// Unable to send view update //////////////////////////////////////"+b)})},b.prototype.rpcOnConnection=function(){var b=this,c=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo;b._customerCobrowseProvider.callJsonRPC("customerservice","onConnection",c.custAuthCode,b._customerCobrowseProvider.getProtocol.call(b._customerCobrowseProvider),function(c){a.Base.CobrowseLogger.info("onConnection:: onConnection send to agent: "+c),b.startOnConnection.call(b)},function(b){a.Base.CobrowseLogger.error("startSession:: Error occurred while sending onConnection: to agent"+b)})},b.prototype.rpcConnectToAnAgent=function(){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,d=this,e=!1,f=!1;b.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(f=!0),b.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE&&(e=!0),d._customerCobrowseProvider.callJsonRPC("customerservice","connectToAnAgent",b.custAuthCode,d._customerCobrowseProvider.getProtocol.call(d._customerCobrowseProvider),c(),function(c){a.Base.CobrowseLogger.info("startSession:: Session established. msg: "+c);var g=d.getCustomerDataSet().coBrowseData;d.getCustomerDataSet().updateDataset(g),d.onStart({paused:e,agentControl:f,agentName:b.agentName,customerName:b.customerName,ctrlReqPending:d._ctrlReqPending,key:b.passPhrase}),e||f?d.stopInactiveTimer():d.startInactiveTimer(),d.registerCallbacks(),d.rpcOnConnection()},function(b){a.Base.CobrowseLogger.error("startSession:: Error occurred while establishing the session"),d.onFail({msg:"Unable to Join Session ("+b.message+")"})})},b.prototype.onGetNextViewUpdateCallBack=function(){this.startViewSync.call(this,!1)},b.prototype.onControlRequestCallBack=function(){if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE)a.Base.CobrowseLogger.info("Agent is already have control.");else{var b=this.getCustomerDataSet().coBrowseData;b.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLPENDINGSTATE,this.getCustomerDataSet().updateDataset(b),this.onControlRequest({agent:this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentName})}},b.prototype.onControlReleaseCallBack=function(){var b=this.getCustomerDataSet().coBrowseData;b.coBrowseSessionInfo.agentControlState=a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLFALSESTATE,this.getCustomerDataSet().updateDataset(b),this.onControlRelease({agent:b.coBrowseSessionInfo.agentName}),this.startInactiveTimer(),this.enableMouseSync(!0),this.cleanHighlightedNode(),this.startViewSync.call(this,!1),this._updateOnCtrlChg(!1)},b.prototype.onRemoteActionCallBack=function(a){if(null!==a){if($(a.cssSelector).hasClass("avcobrowse-mask"))return;if($(a.cssSelector).hasClass("avcobrowse-block"))return;var b;if("click"===a.event){if(b=document.getElementById(a.id),null===b&&(b=$(a.cssSelector).get(0)),void 0===b)return;b.click(),($(b).is(":radio")||$(b).is(":checkbox"))&&(this.highlightOnAgentTouch($(b)),$(b).blur()),this.repeatedViewSync()}else if("keyup"===a.event)if(a.id){if($("#"+a.id).val(a.value),$("#"+a.id).addClass("cbe-agent-touch"),a.scrollTop&&$("#"+a.id).scrollTop(a.scrollTop),"text"===a.type&&null!==a.index&&"13"===a.index){a.keycode="13",a.index="";var c=$.Event("keyup");c.keyCode=13,$("#"+a.id).trigger(c,a),this.repeatedViewSync()}}else $(a.cssSelector).val(a.value),$(a.cssSelector).addClass("cbe-agent-touch"),a.scrollTop&&$(a.cssSelector).scrollTop(a.scrollTop);else if("focusin"===a.event){if(void 0===(b=document.getElementById(a.id)))return;"text"===a.type&&($(b).val(a.value),$(b).addClass("cbe-agent-touch"),$(b).trigger(a.event,a))}else if("blur"===a.event){if(void 0===(b=document.getElementById(a.id)))return;"text"===a.type&&($(b).val(a.value),$(b).addClass("cbe-agent-touch"),$(b).trigger(a.event,a))}else if("change"===a.event){if(b=document.getElementById(a.id),null===b&&(b=$(a.cssSelector).get(0)),void 0===b)return;"text"===a.type?($(b).val(a.value),$(b).addClass("cbe-agent-touch"),$(b).trigger(a.event,a),this.repeatedViewSync()):a.index&&(b.selectedIndex=a.index,$(b).addClass("cbe-agent-touch"),$(b).trigger(a.event,a),this.repeatedViewSync())}else if("mouseenter"===a.event||"mouseleave"===a.event){if(void 0===(b=$(a.cssSelector)))return;try{b.trigger(a.event),this.repeatedViewSync()}catch(d){}}else"refresh"===a.event&&this.startViewSync.call(this,!0)}},b.prototype.onSessionClosedCallBack=function(a){this.shutdown(),this.stopInactiveTimer(),this.onSessionClose({msg:a})},b.prototype.onMousePosCallBack=function(a){this.onMousePos(a)},b.prototype.onScrollCallBack=function(a){this.onScroll(a)},b.prototype.onAgentJoinCallBack=function(a){null!==a&&(this._isAgentJoined=!0,$.extend(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,a),this.stopViewSync(),this.onAgentJoin(a),this.startOnConnection.call(this))},b.prototype.onMouseSelCallBack=function(a){if(null!==a){var b,c=a.mhighlightText;b=this.cleanHighlightedNode(),c&&c.length>0&&(this.createRangeAndHighlight(c,$("body")),b=!0),b&&this.startViewSync.call(this,!1)}},b.prototype.inactiveTimeCallBack=function(a){this.rpcInactiveTime(this._customerCobrowse,a)},b.prototype.agentMovedAwayCallBack=function(){this.onAgentDead()},b.prototype.registerCallbacks=function(){this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONGETNEXTUPDATE,this.onGetNextViewUpdateCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONCONTROLREQUEST,this.onControlRequestCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONCONTROLRELEASE,this.onControlReleaseCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONREMOTEACTION,this.onRemoteActionCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONSESSIONCLOSED,this.onSessionClosedCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONMOUSEUPDATE,this.onMousePosCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONSCROLLUPDATE,this.onScrollCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONAGENTJOIN,this.onAgentJoinCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.ONMOUSESEL,this.onMouseSelCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.INACTIVETIME,this.inactiveTimeCallBack,this),this._customerCobrowseProvider.registerServerCallback(a.Services.Cobrowse.Common.CobrowseConstants.AGENTMOVEDAWAY,this.agentMovedAwayCallBack,this)},b.prototype.openConnection=function(){var b=this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo,c=this;if(!b.custAuthCode)return void c.onFail({msg:"Unable to open Connection (Session expired!)"});if(this._customerCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_OPEN,function(){try{c.rpcConnectToAnAgent.call(c)}catch(a){c.onFail({msg:"Unable to Join Session (Unknown Error)"})}}),c._customerCobrowseProvider.attachNetworkEvent(a.Providers.Cobrowse.ObservableEvents.SOCKET_ON_CLOSE,function(b){if(a.Base.CobrowseLogger.error("evtConnectionClose:: connection closed :SockJS: "+JSON.stringify(b)),1006===b.code?(c.onFail({msg:"Conn Err! Retrying.."}),c.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(c.stopViewSync(),c._updateOnCtrlChg(!0))):c.onFail({msg:"Connection closed :SockJS ("+b+")"}),!c._connRetryTimer){var d=c.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.custAuthCode;c.shutdown(),a.Base.CobrowseCookie.set("ACS_TOKEN",d,null),c._connRetryTimer=setInterval(function(){c.resetInactiveCounter(),a.Base.CobrowseLogger.warn("evtConnectionClose:: retrying to connect again"),c.statusSession()},c._connRetryInterval)}}),c.getCustomerDataSet().coBrowseData.redirectURL){var d=a.Providers.Cobrowse.Customer.CustomerCobrowseURLProvider.SOCKETSERVICEURL+"/?affinity="+c.getCustomerDataSet().coBrowseData.redirectURL;c._customerCobrowseProvider.startSocketConnection(d)}else c._customerCobrowseProvider.startSocketConnection()},b.prototype.generateErrorObject=function(a){var b={errorMessage:"",errorCode:"",errorDetails:""};if(!a)return b;if(b.errorDetails=a,a.errorMessage)b.errorMessage=a.errorMessage,b.errorCode&&(b.errorCode=a.errorCode);else if(a.data){var c=a.data.split("::");c.length>0&&(b.errorMessage=c[1],b.errorCode=c[0])}else{if(!a.statusText)return b;b.errorMessage=a.statusText,b.errorCode&&(b.errorCode=a.status)}return b},a.Services.Cobrowse.Customer.CustomerCobrowseService=b}(AvayaCoBrowseClientServices),function(a){"use strict";function b(){this._vSyncTimer=void 0,this._md5=void 0,this._dom=void 0,this._h_dom_b64=void 0,this._md5_h=void 0,this._vSyncInterval=1200,this._mmSyncInterval=900,this._mmSyncTimer=void 0,this._rPtr=void 0,this._mask=void 0,this._mLocalNode=void 0,this._mNodeCssOld=void 0,this._mNodeCss=void 0,this._mX=0,this._mY=0,this._mXO=0,this._mYO=0,this.isHighilightEnabled=!0,this.agentHighilightFeatureEnabled=!0,this._agentViewSyncInterval=500,this._scrollTop=0,this._scrollTopOld=0,this._scrollLeft=0,this._scrollLeftOld=0,this._inactiveCounter=0,this.backgroundColor="yellow",this._ctrlReqPending=!1,this._connRetryTimer=null,this._connRetryInterval=1e4,this._inactiveTimer=null,this._inactiveCounter=0,this._inactiveInterval=5e3,this._removeElementList=[],this._isAgentJoined=!0}a.Services.Cobrowse.Customer.CustomerCobrowseServiceData=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";function c(c){this._cobrowseConfig=c,this._customerCobrowseService=new a.Services.Cobrowse.Customer.CustomerCobrowseService(this),this._addOnfireInactivityCallbacks=b.Callbacks(),this._addOnStopInactivityTimerCallbacks=b.Callbacks(),this._coBrowseCapability=new a.Base.CoBrowseCapability(a.Base.CobrowseCapabilityDenialReason.CAPABILITY_INVALID_STATE),this._init()}c.prototype={_init:function(){if(!this._cobrowseConfig)throw"Cobrowse configuration is not defined.";this._customerCobrowseService.init(this._cobrowseConfig).then(function(b){"success"!==b.acsResult&&a.Base.CobrowseLogger.error("Cobrowse configuration is not correct, error while communicating with server"),this._coBrowseCapability._updateIfChanged(!0,a.Base.CobrowseCapabilityDenialReason.CAPABILITY_NOT_DENIED),a.Base.CobrowseLogger.info("Successfully initialized cobrowse service")}.bind(this),function(b){a.Base.CobrowseLogger.error("Cobrowse configuration is not correct, error while communicating with server==>"+b)})},getCustomerData:function(){return this._customerCobrowseService.getCustomerDataSet()&&this._customerCobrowseService.getCustomerDataSet().coBrowseData?this._customerCobrowseService.getCustomerDataSet().coBrowseData.coBrowseSessionInfo:new a.Base.CobrowseSessionInfo},requestSession:function(a,b,c){return this._customerCobrowseService.requestSession({name:a,locale:b,emailid:c})},joinSession:function(a,b,c){return this._customerCobrowseService.joinSession({name:a,sessionkey:b,emailid:c})},start:function(){this._customerCobrowseService.statusSession()},logoutSession:function(a){return this._customerCobrowseService.logoutSession({reason:a})},grantControl:function(){return this._customerCobrowseService.rpcGrantControl()},denyControl:function(){return this._customerCobrowseService.rpcDenyControl()},revokeControl:function(){return this._customerCobrowseService.rpcRevokeControl()},pause:function(){return this._customerCobrowseService.rpcPause()},resume:function(){return this._customerCobrowseService.rpcResume()},updateIdleTime:function(a){this._customerCobrowseService.rpcUpdateIdleTime(a)},addElementIDToRemove:function(a){this._customerCobrowseService.addElementIDToRemove(a)}},a.Services.Cobrowse.Customer.CustomerCobrowse=c}(AvayaCoBrowseClientServices,jQuery),function(a){"use strict";var b={EVENT_ON_ONREADY:"cbprovider.onReady",EVENT_ON_START:"cbprovider.onStart",EVENT_ON_FAIL:"cbprovider.onFail",EVENT_ON_CONTROLREQUEST:"cbprovider.onControlRequest",EVENT_ON_CONTROLRELEASE:"cbprovider.onControlRelease",EVENT_ON_SESSIONCLOSE:"cbprovider.onSessionClose",EVENT_ON_AGENTJOIN:"cbprovider.onAgentJoin",EVENT_ON_AGENTLIVE:"cbprovider.onAgentAlive",EVENT_ON_AGENTDEAD:"cbprovider.onAgentDead"};a.Services.Cobrowse.Customer.ObservableCustomerEvents=b}(window.AvayaCoBrowseClientServices=window.AvayaCoBrowseClientServices||{}),function(a,b){"use strict";var c={addOnPauseCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE,b)},removeOnPauseCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_PAUSE,b)},addOnResumeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME,b)},removeOnResumeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_RESUME,b)},addOnControlGrantCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT,b)},removeOnControlGrantCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_GRANT,b)},addOnControlDenialCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL,b)},removeOnControlDenialCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_DENIAL,b)},addOnControlRevokeCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE,b)},removeOnControlRevokeCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CONTROL_REVOKE,b)},addOnSessionCloseCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},removeOnSessionCloseCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_SESSION_CLOSE,b)},addOnCustomerJoinCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN,b)},removeOnCustomerJoinCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_JOIN,b)},addOnConnectionCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},removeOnConnectionCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_START,b)},addOnConnectionFailureCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},removeOnConnectionFailureCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_FAIL,b)},addOnInActivityTimeOutOccurredCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},removeOnInActivityTimeOutOccurredCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_INACTIVITY_TIMEOUT,b)},addOnStopInActivityTimeOutCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},removeOnStopInActivityTimeOutCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_STOPINACTIVITY_TIMEOUT,b)},addOnCustomerDeadCallback:function(b){this._agentCobrowseService.on(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD,b)},removeOnCustomerDeadCallback:function(b){this._agentCobrowseService.off(a.Services.Cobrowse.Agent.ObservableAgentEvents.EVENT_ON_CUSTOMER_DEAD,b)}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={enableMouseSync:function(c){var d=this;if(this._mLocalNode&&(this._mLocalNode.remove(),a.Base.CobrowseLogger.info("enableMouseSync: removing highlight")),d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE||d.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||!c)return d._mmSyncTimer&&clearInterval(d._mmSyncTimer),a.Base.CobrowseLogger.info("Skip _mmSync: paused or agentControl"),void(b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().unbind("mousemove"));b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().mousemove(function(a){d._mX=a.pageX-3,d._mY=a.pageY-4}),this._mmSyncTimer=setInterval(function(){d.mmSync.call(d)},d._mmSyncInterval)},doScrollSync:function(){var c=null,d=null
;if(this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(b(this._iframeDivSelector).length>0&&(c=b(this._iframeDivSelector).contents().scrollLeft(),d=b(this._iframeDivSelector).contents().scrollTop()),d!==this._scrollTopOld||c!==this._scrollLeftOld)){this._scrollLeftOld=c,this._scrollTopOld=d;var e={scrollTop:d,scrollLeft:c};this.rpcSendScrollPos(e)}},mmSync:function(){this.getAgentDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE&&(this._mX===this._mXO&&this._mY===this._mYO&&this._mNodeCss===this._mNodeCssOld||(this._mXO=this._mX,this._mYO=this._mY,this._mNodeCssOld=this._mNodeCss,this._inactiveCounter=0,this.rpcSendMousePos()),this.doScrollSync())},onMouseUpdateCallBack:function(a){if(null!==a||void 0!==a){var c;c=b(this._iframeDivSelector).length>0?b(b(this._iframeDivSelector).contents().find("body").find(a.cssSelector).get(0)):void 0,c&&c.length>0&&(this._mLocalNode&&this._mLocalNode.remove(),b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector).contents().find("body").append(this.highlight(c))),this._mXr=a.mX+"px",this._mYr=a.mY+"px",this._mPtr.css({top:this._mYr,left:this._mXr})}},highlight:function(c){var d="cbe-highlight";c.is("img")&&(d="cbe-highlight-img");try{this._mLocalNode=b('<div id="cbeHighlightId"></div>').addClass(d).css({top:c.offset().top-4+"px",left:c.offset().left-4+"px",width:c.outerWidth()+6+"px",height:c.outerHeight()+6+"px"})}catch(e){a.Base.CobrowseLogger.warn("Exception in highlight: "+e)}return this._mLocalNode},onScrollUpdateCallBack:function(c){a.Base.CobrowseLogger.info("on Scroll Update : "+c),c&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)?window.scrollTo(c.scrollLeft,c.scrollTop):b(this._iframeDivSelector).length>0&&b(this._iframeDivSelector)[0].contentWindow.scrollTo(c.scrollLeft,c.scrollTop))},getTextRange:function(){var c=[],d=null,e=null,f=document.getElementById(this._iframeDivID),g=f&&f.contentWindow,h=g&&g.document;try{if(g.getSelection?(d=g.getSelection().getRangeAt(0),e=g.getSelection().toString()):h.selection&&"Control"!==h.selection.type&&(d=h.selection().createRange().getRangeAt(0),e=h.selection.createRange().text),!e)return;var i=d.startContainer,j=d.endContainer,k=d.commonAncestorContainer;c[0]=d.startOffset,c[1]=d.endOffset,i&&3===i.TEXT_NODE?(c[2]=b(i.parentNode).getPath(),c[3]=Array.prototype.indexOf.call(i.parentNode.childNodes,i)):(c[2]=b(i).getPath(),c[3]=-1),j&&3===j.TEXT_NODE?(c[4]=b(j.parentNode).getPath(),c[5]=Array.prototype.indexOf.call(j.parentNode.childNodes,j)):(c[4]=b(j).getPath(),c[5]=-1),c[6]=b(k).getPath()}catch(l){a.Base.CobrowseLogger.warn("error is: "+l.message)}return c},startTracker:function(){var c=this;if(a.Base.CobrowseLogger.info("_startTracker: begin"),0===b(this._iframeDivSelector).length)return a.Base.CobrowseLogger.info("IFrame not found"),!1;var d=b(this._iframeDivSelector).contents(),e=d.find("body");b(e).contents().on({mouseup:function(){return c.rpcOnMouseSel(),!1}}),b(d).find("a").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).attr("href");return a.stopPropagation(),a.preventDefault(),c.rpcSyncAction({event:"click",type:e,id:d,cssSelector:f,value:g}),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),c._expectScrollUpdate=!0,!1}),b(d).find("button").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).prop("textContent");a.preventDefault(),a.stopPropagation();var h={event:"click",type:e,id:d,cssSelector:f,value:g};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find("input").click(function(a){var d,e,f,g=b(this).attr("id"),h=b(this).attr("type");return"submit"===h?(d=b(this).getPath(),a.preventDefault(),a.stopPropagation(),e=b(this).val(),f={event:"click",type:h,id:g,cssSelector:d,value:e},c.rpcSyncAction(f),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1):"button"===h?(d=b(this).getPath(),a.preventDefault(),a.stopPropagation(),e=b(this).val(),f={event:"click",type:h,id:g,cssSelector:d,value:e},c.rpcSyncAction(f),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1):void 0}),b(d).find(":checkbox").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).prop("checked");a.stopPropagation(),a.preventDefault();var h={event:"click",type:e,id:d,cssSelector:f,value:g};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find(":radio").click(function(){var a=b(this).attr("id"),d=b(this).attr("type"),e=b(this).getPath(),f=b(this).prop("checked"),g={event:"click",type:d,id:a,cssSelector:e,value:f};return c.rpcSyncAction(g),!1}),b(d).find("label").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).text();a.stopPropagation(),a.preventDefault();var h={event:"click",type:e,id:d,cssSelector:f,value:g};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find("span").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath();a.stopPropagation(),a.preventDefault();var g={event:"click",type:e,id:d,cssSelector:f};return c.rpcSyncAction(g),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find("li").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).find("option:selected").text();a.stopPropagation(),a.preventDefault();var h={event:"click",type:e,id:d,cssSelector:f,value:g,index:this.selectedIndex};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find("select").change(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath(),g=b(this).find("option:selected").text();a.stopPropagation(),a.preventDefault();var h={event:"change",type:e,id:d,cssSelector:f,value:g,index:this.selectedIndex};return c.rpcSyncAction(h),!1}),b(d).find("input").change(function(a){var d=b(this).attr("id"),e=b(this).attr("type");if("text"===e){var f=b(this).getPath(),g=b(this).val();a.stopPropagation(),a.preventDefault();var h={event:"change",type:e,id:d,cssSelector:f,value:g};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}}),b(d).find("input").blur(function(a){var d=b(this).attr("id"),e=b(this).attr("type");if("text"===e){var f=b(this).getPath(),g=b(this).val();a.stopPropagation(),a.preventDefault();var h={event:"blur",type:e,id:d,cssSelector:f,value:g};return c.rpcSyncAction(h),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}}),b(d).find("input").keyup(function(a){var d=b(this).attr("id"),e=b(this).getPath(),f=b(this).attr("type"),g=this.value,h=null;"text"===f&&13===a.keyCode?(h={event:"keyup",id:d,cssSelector:e,type:f,value:g,index:"13"},b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait")):h={event:"keyup",id:d,cssSelector:e,type:f,value:g},c.rpcSyncAction(h)}),b(d).find("input").focusin(function(a){var d=b(this).attr("id"),e=b(this).getPath(),f=b(this).attr("type"),g=this.value,h=null;if("text"===f)return h={event:"focusin",id:d,cssSelector:e,type:f,value:g},b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),void c.rpcSyncAction(h)}),b(d).find("textarea").keyup(function(){var a=b(this).attr("id"),d=b(this).getPath(),e=b(this).attr("type"),f=this.value,g=b(this).scrollTop(),h={event:"keyup",id:a,cssSelector:d,type:e,value:f,scrollTop:g};c.rpcSyncAction(h)}),b(d).find("textarea").scroll(function(){var a=b(this).attr("id"),d=b(this).getPath(),e=b(this).attr("type"),f=this.value,g=b(this).scrollTop(),h={event:"keyup",id:a,cssSelector:d,type:e,value:f,scrollTop:g};c.rpcSyncAction(h)}),b(d).find("div.current").click(function(a){var d=b(this).attr("id"),e=b(this).attr("type"),f=b(this).getPath();a.stopPropagation(),a.preventDefault();var g={event:"click",type:e,id:d,cssSelector:f,value:this.selectedIndex};return c.rpcSyncAction(g),b(this._iframeDivSelector).contents().find("body").addClass("cbe-cursor-wait"),!1}),b(d).find("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object, nav > li, nav > li > div").each(function(){b(this).focusin(function(){c.handleEvtForNode(b(this),"focusin")}),b(this).mouseenter(function(){c.handleEvtForNode(b(this),"mouseenter")}),b(this).mouseleave(function(){c.handleEvtForNode(b(this),"mouseleave")})})},stopTracker:function(){a.Base.CobrowseLogger.info("_stopTracker ..."),b(this._iframeDivSelector).length>0&&(b(this._iframeDivSelector).contents().unbind(),b(this._iframeDivSelector).contents().off())},onMouseSelCallBack:function(){this.rpcOnMouseSel()}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={createRequestSessionArguments:function(){return{apikey:"defaultapikey",extkey:void 0,name:void 0,autoJoin:!1,locale:"en_US",emailid:void 0}},createJoinSessionArguments:function(){return{acstoken:void 0,useragent:void 0}},createLiveJoinSessionArguments:function(){return{sessionkey:void 0,name:void 0,clientname:void 0,emailid:void 0,extkey:void 0}},createStatusArguments:function(){return{acstoken:void 0}},createLogoutSessionArguments:function(){return{acstoken:void 0,reason:"logout",eurl:void 0}}};b.extend(a.Services.Cobrowse.Agent.AgentCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={addOnConnectionResetCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},removeOnConnectionResetCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_ONREADY,b)},addOnConnectionCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},removeOnConnectionCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_START,b)},addOnConnectionFailureCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},removeOnConnectionFailureCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_FAIL,b)},addOnControlRequestCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b)},removeOnControlRequestCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLREQUEST,b)},addOnControlReleaseCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},removeOnControlReleaseCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_CONTROLRELEASE,b)},addOnSessionCloseCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},removeOnSessionCloseCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_SESSIONCLOSE,b)},addOnAgentJoinCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},removeOnAgentJoinCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTJOIN,b)},addOnAgentDeadCallback:function(b){this._customerCobrowseService.on(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},removeOnAgentDeadCallback:function(b){this._customerCobrowseService.off(a.Services.Cobrowse.Customer.ObservableCustomerEvents.EVENT_ON_AGENTDEAD,b)},addOnfireInactivityCallback:function(a){this._addOnfireInactivityCallbacks.add(a)},removeOnfireInactivityCallback:function(a){this._addOnfireInactivityCallbacks.remove(a)},addOnStopInactivityTimerCallback:function(a){this._addOnStopInactivityTimerCallbacks.add(a)},removeOnStopInactivityTimerCallback:function(a){this._addOnStopInactivityTimerCallbacks.remove(a)}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={getTextRange:function(){var c=[],d=null,e=null;try{if(window.getSelection?(d=window.getSelection().getRangeAt(0),e=window.getSelection().toString()):document.selection&&"Control"!==document.selection.type&&(d=document.selection().createRange().getRangeAt(0),e=document.selection.createRange().text),!e)return;var f=d.startContainer,g=d.endContainer,h=d.commonAncestorContainer;c[0]=d.startOffset,c[1]=d.endOffset,f&&3===f.TEXT_NODE?(c[2]=b(f.parentNode).getPath(),c[3]=Array.prototype.indexOf.call(f.parentNode.childNodes,f)):(c[2]=b(f).getPath(),c[3]=-1),g&&3===g.TEXT_NODE?(c[4]=b(g.parentNode).getPath(),c[5]=Array.prototype.indexOf.call(g.parentNode.childNodes,g)):(c[4]=b(g).getPath(),c[5]=-1),c[6]=b(h).getPath()}catch(i){a.Base.CobrowseLogger.warn("range error is: "+i.message)}return c},createRangeAndHighlight:function(a,b){var c=a[0],d=a[1],e=b.find(a[2]).get(0);e||(-1!==a[2].indexOf("html>body>")?e=b.find(a[2].substring("html>body>".length)).get(0):-1!==a[2].indexOf("html > body > ")&&(e=b.find(a[2].substring("html > body > ".length)).get(0)));var f=parseInt(a[3]),g=b.find(a[4]).get(0);g||(-1!==a[4].indexOf("html>body>")?g=b.find(a[4].substring("html>body>".length)).get(0):-1!==a[4].indexOf("html > body > ")&&(g=b.find(a[4].substring("html > body > ".length)).get(0)));var h=parseInt(a[5]);if(e&&g){-1!==f?(e=e.childNodes[f],-1!==h&&(g=g.childNodes[h])):-1!==h&&(g=g.childNodes[h]);for(var i,j=0,k=!0,l=e;k;){if(e.isEqualNode(g)){this.traverseChildNodes(e,l,g,c,d);break}if(i=e,i.nextSibling)i=i.nextSibling;else{if(!i.parentNode)break;if(!i.parentNode.nextSibling){e=i.parentNode;continue}i=i.parentNode.nextSibling}j++,k=this.traverseChildNodes(e,l,g,c,d),e=i}}},traverseChildNodes:function(c,d,e,f,g){var h,i=!0;if(c.isEqualNode(e)&&(i=!1),b.each(this._removeElementList,function(b,d){if(a.Base.CobrowseLogger.debug("Removing from highlight text=>"+b+":"+d),c.id&&c.id===d)return i}),1===c.nodeType)for(c=c.firstChild;c&&(h=c.nextSibling,i=this.traverseChildNodes(c,d,e,f,g));)c=h;else 3===c.nodeType&&(c.nodeValue.trim().length>0||c.wholeText.trim().length>0)&&(c.isEqualNode(d)&&c.isEqualNode(e)?this.wrapMatchesInNode(c,"alone",f,g):c.isEqualNode(e)?this.wrapMatchesInNode(c,"end",f,g):c.isEqualNode(d)?this.wrapMatchesInNode(c,"start",f,g):this.wrapMatchesInNode(c,"",0,0));return i},wrapMatchesInNode:function(a,c,d,e){var f=a.nodeValue;f||(f=a.wholeText);var g,h;"start"===c?(g=f.substring(0,d),g+="<span style='background-color:"+this.backgroundColor+"'>"+f.substring(d)+"</span>"):"end"===c?(g="<span style='background-color:"+this.backgroundColor+"'>"+f.substring(0,e)+"</span>",g+=f.substring(e)):"alone"===c?(g=f.substring(0,d),g+="<span style='background-color:"+this.backgroundColor+"'>"+f.substring(d,e)+"</span>",g+=f.substring(e)):g="<span style='background-color:"+this.backgroundColor+"'>"+f+"</span>",(h=!a.parentNode||"SPAN"!==a.parentNode.nodeName||a.parentNode.style.backgroundColor!==this.backgroundColor)&&b(a).replaceWith("<span class='cbe_remove'>"+g+"</span>")},cleanHighlightedNode:function(){var a=!1;return b(".cbe_remove").each(function(){b(this).replaceWith(function(){return b(this).text()}),a=!0}),a}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={enableMouseSync:function(c){var d=this;this._mLocalNode&&(this._mLocalNode.remove(),a.Base.CobrowseLogger.info("enableMouseSync: removing highlight"));var e=!1;if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState!==a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE&&this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState!==a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE||(e=!0),e||!c)return this._mmSyncTimer&&(clearInterval(this._mmSyncTimer),this._mmSyncTimer=void 0),a.Base.CobrowseLogger.info("Skip _mmSync: paused or agentControl"),b(document).unbind("mousemove"),b(document).unbind("mouseup"),void b("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object, li").each(function(){b(this).unbind("focusin",d.highlightIn),b(this).unbind("mouseenter",d.highlightIn),b(this).unbind("click",d.highlightIn)});b(document).unbind("mouseup"),b(document).mouseup(function(){d.highlightText.call(d)}),b(document).mousemove(function(a){d._mX=a.pageX-3,d._mY=a.pageY-4}),b(document).keyup(function(){d.resetInactiveCounter()}),this._mmSyncTimer||(this._mmSyncTimer=setInterval(function(){d._mmSync.call(d)},d._mmSyncInterval)),b("a, input, textarea, select, option, optgroup, button, fieldset, legend, img, area, map, object, li").each(function(){d.highlightElement(b(this),d)})},highlightText:function(){var a;if(this._isAgentJoined&&this.isHighilightEnabled&&this.agentHighilightFeatureEnabled){var c=this.getTextRange();a=this.cleanHighlightedNode(),c&&c.length>0&&(this.createRangeAndHighlight(c,b("body")),a=!0),a&&this.startViewSync.call(this,!1)}},highlightElement:function(a,b){a.focusin(function(){b.highlightIn.call(this,b)}),a.mouseenter(function(){b.highlightIn.call(this,b)}),a.click(function(){b.highlightIn.call(this,b)})},highlightIn:function(c){try{c._mNodeCss=b(this).getPath(),c._mNodeId=b(this).attr("id")}catch(d){a.Base.CobrowseLogger.error("Exception while highlightIn - "+d)}},_mmSync:function(){if(this._mX!==this._mXO||this._mY!==this._mYO||this._mNodeCss!==this._mNodeCssOld){this._mXO=this._mX,this._mYO=this._mY,this._mNodeCssOld=this._mNodeCss,this._inactiveCounter=0;var a={event:"mousemove",mX:this._mX,mY:this._mY,id:this._mNodeId,cssSelector:this._mNodeCss};this.rpcSendMousePos(a)}this.doScrollSync.call(this)},doScrollSync:function(){if(this._scrollLeft=b(window).scrollLeft(),this._scrollTop=b(window).scrollTop(),this._scrollTop!==this._scrollTopOld||this._scrollLeft!==this._scrollLeftOld){this._inactiveCounter=0,this._scrollLeftOld=this._scrollLeft,this._scrollTopOld=this._scrollTop;var a={event:"scroll",scrollTop:this._scrollTop,scrollLeft:this._scrollLeft};this.rpcSendScrollPos(a)}}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={createRequestSessionArguments:function(){return{apikey:"defaultapikey",name:void 0,autoJoin:!0,locale:"en_US",emailid:void 0,useragent:void 0,eurl:void 0}},createJoinSessionArguments:function(){return{sessionkey:void 0,name:void 0,locale:"en_US",emailid:void 0,useragent:void 0}},createStatusArguments:function(){return{acstoken:void 0}},createLogoutSessionArguments:function(){return{acstoken:void 0,reason:"logout",eurl:void 0}}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowse.prototype,c)}(AvayaCoBrowseClientServices,jQuery),function(a,b){"use strict";var c={startOnConnection:function(){this.enableMouseSync.call(this,!0),this.startViewSync.call(this,!1),this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.agentControlState===a.Services.Cobrowse.Common.AgentControlState.AGENTCONTROLTRUESTATE?this._updateOnCtrlChg(!0):this._updateOnCtrlChg(!1),b(".cbe-mask-help").remove(),b(".cbe-block-help").remove(),b(".avcobrowse-mask").after('<div class="cbe-mask-help" title="This field is hidden from Agent" />'),b(".avcobrowse-block").before('<div class="cbe-block-help" title="This Action is blocked for the Agent" />')},_updateOnCtrlChg:function(a){b("#cbePtr").remove(),b("#cbeMask").remove(),b("body").css("cursor","auto"),b("body").find("input").unbind("keydown",this.disableTabControl),b("body").find("a").unbind("keydown",this.disableTabControl),a&&(this._rPtr=b('<div id="cbePtr" class="cbe-remote-cursor"></div>'),this._mask=b('<div id="cbeMask" class="cbe-readonly-mask"></div>').css({width:b(document).width(),height:b(document).height()}),b("body").append(this._mask,this._rPtr),b("body").css("cursor","not-allowed"),b("body").find("input").bind("keydown",this.disableTabControl),b("body").find("a").bind("keydown",this.disableTabControl))},disableTabControl:function(b){9===b.keyCode&&(a.Base.CobrowseLogger.log("Event tab recieved, killing it"),b.preventDefault())},startViewSync:function(c){if(this.getCustomerDataSet().coBrowseData.coBrowseSessionInfo.cobrowseState===a.Services.Cobrowse.Common.CobrowseState.COBROWSEPAUSEDSTATE)return void(this._vSyncTimer&&clearTimeout(this._vSyncTimer));if(!this._vSyncCheck(c)){this._vSyncTimer&&clearTimeout(this._vSyncTimer);var d=this;return this._vSyncTimer=setTimeout(function(){d._vSyncTimerFunc.call(d)},d._vSyncInterval),void a.Base.CobrowseLogger.debug("No Change, Check after "+this._vSyncInterval+" ms")}this._vSyncTimer&&clearTimeout(this._vSyncTimer);var e={data:this._dom,cssData:this._h_dom_b64,windowSize:JSON.stringify({w:b(window).width(),h:b(window).height()}),scrollPosition:JSON.stringify({scrollX:b(window).scrollLeft(),scrollY:b(window).scrollTop()})};this.rpcSendViewUpdate(e)},_vSyncCheck:function(b){if(b&&!0===b)return a.Base.CobrowseLogger.info("[AgentInControl] Pushing OnDemand Update"),this._md5="",this._md5_h="",this._dom=this._vSyncCreate(!0),a.Base.CobrowseLogger.info("DOM Length (b64) = "+this._dom.length),!0;var c=this._vSyncCreate(!1),d=md5(c);return this._md5!==d?(this._md5=d,this._dom=Base64.encode(c),a.Base.CobrowseLogger.info("$$ view update available len (b64) = "+this._dom.length),!0):(a.Base.CobrowseLogger.debug("%% checksum optimization: nothing available"),!1)},_vSyncTimerFunc:function(){this.startViewSync.call(this,!1)},_vSyncCreate:function(c){this._vSyncCreateHeadSection(),a.Base.CobrowseLogger.debug("/////////////////// View PRE-PROCESSING BEGIN /////////////////// ");var d=b();try{d=b("body").clone(!0,!0)}catch(e){a.Base.CobrowseLogger.debug("Exception while cloning body: "+e)}return d=new a.Services.Cobrowse.Customer.CustomerCobrowseHtmlBody(this,d).updateHtmlBody(),a.Base.CobrowseLogger.debug("/////////////////// View PRE-PROCESSING END /////////////////// "),c?Base64.encode(d.html()):d.html()},_vSyncCreateHeadSection:function(){a.Base.CobrowseLogger.debug("creating Head Section ..");var c=b("head");try{c=b("head").clone(!0,!0)}catch(e){a.Base.CobrowseLogger.debug("Exception while cloning head: "+e)}c=new a.Services.Cobrowse.Customer.CustomerCobrowseHtmlHead(this,c).updateHtmlHead();var d=md5(c);this._md5_h!==d?(this._md5_h=d,a.Base.CobrowseCookie.set("ACS_data_hmd5",d,null),this._h_dom_b64=Base64.encode(c),a.Base.CobrowseLogger.warn("head section change detected - (Y)")):this._h_dom_b64=null},getBaseURL:function(){var a=location.href,b=a.lastIndexOf("/");return a.substring(0,b+1)},getDomainURL:function(){return window.location.protocol+"//"+window.location.hostname},getCurrentURL:function(){return encodeURI(Base64.encode(window.location.href))},shutdown:function(){this.cleanHighlightedNode(),this.enableMouseSync.call(this,!1),this.stopViewSync(),this.getCustomerDataSet().coBrowseData=new a.Base.CobrowseData,this._updateOnCtrlChg(!1),this._customerCobrowseProvider.stopSocketConnection(),a.Base.CobrowseCookie.erase("ACS_TOKEN"),a.Base.CobrowseCookie.erase("ACS_data_hmd5"),this.stopInactiveTimer(),b(".cbe-mask-help").remove(),b(".cbe-block-help").remove()},stopViewSync:function(){clearTimeout(this._vSyncTimer),this._md5="",this._dom="",this._md5_h="",this._h_dom_b64=null,this._ctrlReqPending=!1},repeatedViewSync:function(){var a=this;a.startViewSync.call(a,!1),0!==a._agentViewSyncInterval&&(setTimeout(function(){a.startViewSync.call(a,!1)},a._agentViewSyncInterval),setTimeout(function(){a.startViewSync.call(a,!1)},3*a._agentViewSyncInterval))},highlight:function(a){var c="cbe-highlight";a.is("img")&&(c="cbe-highlight-img");try{this._mLocalNode=b('<div id="cbeHighlightId"></div>').addClass(c).css({top:a.offset().top-4+"px",left:a.offset().left-4+"px",width:a.outerWidth()+6+"px",height:a.outerHeight()+6+"px"})}catch(d){}return this._mLocalNode},highlightOnAgentTouch:function(a){a.addClass("cbe-radio-agent-touch")},onScroll:function(a){null!==a&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)?window.scrollTo(a.scrollLeft,a.scrollTop):b("html,body").animate({scrollTop:a.scrollTop,scrollLeft:a.scrollLeft},500))},onMousePos:function(a){if(null!==a){var c=b(b(a.cssSelector).get(0));if(c&&(this._mLocalNode&&this._mLocalNode.remove(),b("body").append(this.highlight(c))),null===this._rPtr||void 0===this._rPtr)return;this._rPtr.css({top:a.mY-3+"px",left:a.mX-3+"px"})}},startInactiveTimer:function(){this.resetInactiveCounter(),a.Base.CobrowseLogger.info("START INACTIVE TIMER START FOR CUSTOMER "),this._inactiveTimer&&(clearInterval(this._inactiveTimer),this._inactiveTimer=void 0);var b=this;this._inactiveTimer=setInterval(function(){b.incInactiveCounter(),b._inactiveCounter>60*b.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT"]&&(b._customerCobrowse._addOnfireInactivityCallbacks.fire(b.getCustomerDataSet().coBrowseData.options["CB.INACTIVE_TIMEOUT_MESSAGE"]),a.Base.CobrowseLogger.info("fire _onCobrowseRequestSuccessCallbacks "),b.resetInactiveCounter())},b._inactiveInterval)},stopInactiveTimer:function(){a.Base.CobrowseLogger.info(" STOP INACTIVE TIMER ");var b=this;b._inactiveTimer&&(clearInterval(b._inactiveTimer),b._inactiveTimer=void 0),b.resetInactiveCounter(),a.Base.CobrowseLogger.info("fire _addOnStopInactivityTimerCallbacks "),b._customerCobrowse._addOnStopInactivityTimerCallbacks.fire(b._customerCobrowse)},resetInactiveCounter:function(){this._inactiveCounter=0,a.Base.CobrowseLogger.info("RESET COUNTER  "+this._inactiveCounter)},incInactiveCounter:function(){a.Base.CobrowseLogger.info("Increment Inactive Counter "+this._inactiveCounter),this._inactiveCounter=this._inactiveCounter+5},addElementIDToRemove:function(a){this._removeElementList.push(a)}};b.extend(a.Services.Cobrowse.Customer.CustomerCobrowseService.prototype,c)}(AvayaCoBrowseClientServices,jQuery);